/* File: backendmodule.c
 * This file is auto-generated with f2py (version:2.2.2).
 * f2py is a Fortran to Python Interface Generator (FPIG), Second Edition,
 * written by Pearu Peterson <pearu@cens.ioc.ee>.
 * Generation date: Mon Jan 20 18:02:05 2025
 * Do not edit this file directly unless you know what you are doing!!!
 */

#ifdef __cplusplus
extern "C" {
#endif

#ifndef PY_SSIZE_T_CLEAN
#define PY_SSIZE_T_CLEAN
#endif /* PY_SSIZE_T_CLEAN */

/* Unconditionally included */
#include <Python.h>
#include <numpy/npy_os.h>

/*********************** See f2py2e/cfuncs.py: includes ***********************/
#include "fortranobject.h"
#include <math.h>

/**************** See f2py2e/rules.py: mod_rules['modulebody'] ****************/
static PyObject *backend_error;
static PyObject *backend_module;

/*********************** See f2py2e/cfuncs.py: typedefs ***********************/
typedef signed char signed_char;

/****************** See f2py2e/cfuncs.py: typedefs_generated ******************/
/*need_typedefs_generated*/

/********************** See f2py2e/cfuncs.py: cppmacros **********************/

#define pyobj_from_int1(v) (PyLong_FromLong(v))


#define PRINTPYOBJERR(obj)\
    fprintf(stderr,"backend.error is related to ");\
    PyObject_Print((PyObject *)obj,stderr,Py_PRINT_RAW);\
    fprintf(stderr,"\n");


#define pyobj_from_double1(v) (PyFloat_FromDouble(v))

/* See fortranobject.h for definitions. The macros here are provided for BC. */
#define rank f2py_rank
#define shape f2py_shape
#define fshape f2py_shape
#define len f2py_len
#define flen f2py_flen
#define slen f2py_slen
#define size f2py_size


#ifdef DEBUGCFUNCS
#define CFUNCSMESS(mess) fprintf(stderr,"debug-capi:"mess);
#define CFUNCSMESSPY(mess,obj) CFUNCSMESS(mess) \
    PyObject_Print((PyObject *)obj,stderr,Py_PRINT_RAW);\
    fprintf(stderr,"\n");
#else
#define CFUNCSMESS(mess)
#define CFUNCSMESSPY(mess,obj)
#endif


#ifndef max
#define max(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef min
#define min(a,b) ((a < b) ? (a) : (b))
#endif
#ifndef MAX
#define MAX(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef MIN
#define MIN(a,b) ((a < b) ? (a) : (b))
#endif


#if defined(PREPEND_FORTRAN)
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F
#else
#define F_FUNC(f,F) _##f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F##_
#else
#define F_FUNC(f,F) _##f##_
#endif
#endif
#else
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F
#else
#define F_FUNC(f,F) f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F##_
#else
#define F_FUNC(f,F) f##_
#endif
#endif
#endif
#if defined(UNDERSCORE_G77)
#define F_FUNC_US(f,F) F_FUNC(f##_,F##_)
#else
#define F_FUNC_US(f,F) F_FUNC(f,F)
#endif


/* New SciPy */
#define TRYPYARRAYTEMPLATECHAR case NPY_STRING: *(char *)(PyArray_DATA(arr))=*v; break;
#define TRYPYARRAYTEMPLATELONG case NPY_LONG: *(long *)(PyArray_DATA(arr))=*v; break;
#define TRYPYARRAYTEMPLATEOBJECT case NPY_OBJECT: PyArray_SETITEM(arr,PyArray_DATA(arr),pyobj_from_ ## ctype ## 1(*v)); break;

#define TRYPYARRAYTEMPLATE(ctype,typecode) \
        PyArrayObject *arr = NULL;\
        if (!obj) return -2;\
        if (!PyArray_Check(obj)) return -1;\
        if (!(arr=(PyArrayObject *)obj)) {fprintf(stderr,"TRYPYARRAYTEMPLATE:");PRINTPYOBJERR(obj);return 0;}\
        if (PyArray_DESCR(arr)->type==typecode)  {*(ctype *)(PyArray_DATA(arr))=*v; return 1;}\
        switch (PyArray_TYPE(arr)) {\
                case NPY_DOUBLE: *(npy_double *)(PyArray_DATA(arr))=*v; break;\
                case NPY_INT: *(npy_int *)(PyArray_DATA(arr))=*v; break;\
                case NPY_LONG: *(npy_long *)(PyArray_DATA(arr))=*v; break;\
                case NPY_FLOAT: *(npy_float *)(PyArray_DATA(arr))=*v; break;\
                case NPY_CDOUBLE: *(npy_double *)(PyArray_DATA(arr))=*v; break;\
                case NPY_CFLOAT: *(npy_float *)(PyArray_DATA(arr))=*v; break;\
                case NPY_BOOL: *(npy_bool *)(PyArray_DATA(arr))=(*v!=0); break;\
                case NPY_UBYTE: *(npy_ubyte *)(PyArray_DATA(arr))=*v; break;\
                case NPY_BYTE: *(npy_byte *)(PyArray_DATA(arr))=*v; break;\
                case NPY_SHORT: *(npy_short *)(PyArray_DATA(arr))=*v; break;\
                case NPY_USHORT: *(npy_ushort *)(PyArray_DATA(arr))=*v; break;\
                case NPY_UINT: *(npy_uint *)(PyArray_DATA(arr))=*v; break;\
                case NPY_ULONG: *(npy_ulong *)(PyArray_DATA(arr))=*v; break;\
                case NPY_LONGLONG: *(npy_longlong *)(PyArray_DATA(arr))=*v; break;\
                case NPY_ULONGLONG: *(npy_ulonglong *)(PyArray_DATA(arr))=*v; break;\
                case NPY_LONGDOUBLE: *(npy_longdouble *)(PyArray_DATA(arr))=*v; break;\
                case NPY_CLONGDOUBLE: *(npy_longdouble *)(PyArray_DATA(arr))=*v; break;\
                case NPY_OBJECT: PyArray_SETITEM(arr, PyArray_DATA(arr), pyobj_from_ ## ctype ## 1(*v)); break;\
        default: return -2;\
        };\
        return 1


/************************ See f2py2e/cfuncs.py: cfuncs ************************/

static int
int_from_pyobj(int* v, PyObject *obj, const char *errmess)
{
    PyObject* tmp = NULL;

    if (PyLong_Check(obj)) {
        *v = Npy__PyLong_AsInt(obj);
        return !(*v == -1 && PyErr_Occurred());
    }

    tmp = PyNumber_Long(obj);
    if (tmp) {
        *v = Npy__PyLong_AsInt(tmp);
        Py_DECREF(tmp);
        return !(*v == -1 && PyErr_Occurred());
    }

    if (PyComplex_Check(obj)) {
        PyErr_Clear();
        tmp = PyObject_GetAttrString(obj,"real");
    }
    else if (PyBytes_Check(obj) || PyUnicode_Check(obj)) {
        /*pass*/;
    }
    else if (PySequence_Check(obj)) {
        PyErr_Clear();
        tmp = PySequence_GetItem(obj, 0);
    }

    if (tmp) {
        if (int_from_pyobj(v, tmp, errmess)) {
            Py_DECREF(tmp);
            return 1;
        }
        Py_DECREF(tmp);
    }

    {
        PyObject* err = PyErr_Occurred();
        if (err == NULL) {
            err = backend_error;
        }
        PyErr_SetString(err, errmess);
    }
    return 0;
}


static int
double_from_pyobj(double* v, PyObject *obj, const char *errmess)
{
    PyObject* tmp = NULL;
    if (PyFloat_Check(obj)) {
        *v = PyFloat_AsDouble(obj);
        return !(*v == -1.0 && PyErr_Occurred());
    }

    tmp = PyNumber_Float(obj);
    if (tmp) {
        *v = PyFloat_AsDouble(tmp);
        Py_DECREF(tmp);
        return !(*v == -1.0 && PyErr_Occurred());
    }

    if (PyComplex_Check(obj)) {
        PyErr_Clear();
        tmp = PyObject_GetAttrString(obj,"real");
    }
    else if (PyBytes_Check(obj) || PyUnicode_Check(obj)) {
        /*pass*/;
    }
    else if (PySequence_Check(obj)) {
        PyErr_Clear();
        tmp = PySequence_GetItem(obj, 0);
    }

    if (tmp) {
        if (double_from_pyobj(v,tmp,errmess)) {Py_DECREF(tmp); return 1;}
        Py_DECREF(tmp);
    }
    {
        PyObject* err = PyErr_Occurred();
        if (err==NULL) err = backend_error;
        PyErr_SetString(err,errmess);
    }
    return 0;
}

static int try_pyarr_from_double(PyObject* obj,double* v) {
    TRYPYARRAYTEMPLATE(double,'d');
}

static int try_pyarr_from_int(PyObject* obj,int* v) {
    TRYPYARRAYTEMPLATE(int,'i');
}


/********************* See f2py2e/cfuncs.py: userincludes *********************/
/*need_userincludes*/

/********************* See f2py2e/capi_rules.py: usercode *********************/


/* See f2py2e/rules.py */
/*eof externroutines*/

/******************** See f2py2e/capi_rules.py: usercode1 ********************/


/******************* See f2py2e/cb_rules.py: buildcallback *******************/
/*need_callbacks*/

/*********************** See f2py2e/rules.py: buildapi ***********************/

/**************************** active_base_indices ****************************/
static char doc_f2py_rout_backend_backend_active_base_indices[] = "\
result = active_base_indices(mask,nbases)\n\nWrapper for ``active_base_indices``.\
\n\nParameters\n----------\n"
"mask : input rank-2 array('i') with bounds (f2py_mask_d0,f2py_mask_d1)\n"
"nbases : input int\n"
"\nReturns\n-------\n"
"result : rank-1 array('i') with bounds (-1 + nbases)";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_active_base_indices(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int *mask = NULL;
    npy_intp mask_Dims[2] = {-1, -1};
    const int mask_Rank = 2;
    PyArrayObject *capi_mask_as_array = NULL;
    int capi_mask_intent = 0;
    PyObject *mask_capi = Py_None;
    int nbases = 0;
    PyObject *nbases_capi = Py_None;
    int *result = NULL;
    npy_intp result_Dims[1] = {-1};
    const int result_Rank = 1;
    PyArrayObject *capi_result_as_array = NULL;
    int capi_result_intent = 0;
    int f2py_mask_d0 = 0;
    int f2py_mask_d1 = 0;
    static char *capi_kwlist[] = {"mask","nbases",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:backend.backend.active_base_indices",\
        capi_kwlist,&mask_capi,&nbases_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable mask */
    ;
    capi_mask_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.active_base_indices: failed to create array from the 1st argument `mask`";
    capi_mask_as_array = ndarray_from_pyobj(  NPY_INT,1,mask_Dims,mask_Rank,  capi_mask_intent,mask_capi,capi_errmess);
    if (capi_mask_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mask = (int *)(PyArray_DATA(capi_mask_as_array));

    /* Processing variable nbases */
        f2py_success = int_from_pyobj(&nbases,nbases_capi,"backend.backend.active_base_indices() 2nd argument (nbases) can't be converted to int");
    if (f2py_success) {
    /* Processing variable result */
    result_Dims[0]=-1 + nbases;
    capi_result_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.active_base_indices: failed to create array from the hidden `result`";
    capi_result_as_array = ndarray_from_pyobj(  NPY_INT,1,result_Dims,result_Rank,  capi_result_intent,Py_None,capi_errmess);
    if (capi_result_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        result = (int *)(PyArray_DATA(capi_result_as_array));

    /* Processing variable f2py_mask_d0 */
    f2py_mask_d0 = shape(mask, 0);
    /* Processing variable f2py_mask_d1 */
    f2py_mask_d1 = shape(mask, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(mask,&nbases,result,&f2py_mask_d0,&f2py_mask_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_result_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_mask_d1 */
    /* End of cleaning variable f2py_mask_d0 */
    }  /* if (capi_result_as_array == NULL) ... else of result */
    /* End of cleaning variable result */
    } /*if (f2py_success) of nbases*/
    /* End of cleaning variable nbases */
    if((PyObject *)capi_mask_as_array!=mask_capi) {
        Py_XDECREF(capi_mask_as_array); }
    }  /* if (capi_mask_as_array == NULL) ... else of mask */
    /* End of cleaning variable mask */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************* end of active_base_indices *************************/

/******************************** data_matrix ********************************/
static char doc_f2py_rout_backend_backend_data_matrix[] = "\
data_matrix_out,data_matrix_mean = data_matrix(x,basis_indices,mask,truncated,cov,root)\n\nWrapper for ``data_matrix``.\
\n\nParameters\n----------\n"
"x : input rank-2 array('d') with bounds (f2py_x_d0,f2py_x_d1)\n"
"basis_indices : input rank-1 array('i') with bounds (f2py_basis_indices_d0)\n"
"mask : input rank-2 array('i') with bounds (f2py_mask_d0,f2py_mask_d1)\n"
"truncated : input rank-2 array('i') with bounds (f2py_truncated_d0,f2py_truncated_d1)\n"
"cov : input rank-2 array('i') with bounds (f2py_cov_d0,f2py_cov_d1)\n"
"root : input rank-2 array('d') with bounds (f2py_root_d0,f2py_root_d1)\n"
"\nReturns\n-------\n"
"data_matrix_out : rank-2 array('d') with bounds (size(x, 1),size(basis_indices))\n"
"data_matrix_mean : rank-1 array('d') with bounds (size(basis_indices))";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_data_matrix(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,int*,int*,int*,int*,double*,double*,double*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *x = NULL;
    npy_intp x_Dims[2] = {-1, -1};
    const int x_Rank = 2;
    PyArrayObject *capi_x_as_array = NULL;
    int capi_x_intent = 0;
    PyObject *x_capi = Py_None;
    int *basis_indices = NULL;
    npy_intp basis_indices_Dims[1] = {-1};
    const int basis_indices_Rank = 1;
    PyArrayObject *capi_basis_indices_as_array = NULL;
    int capi_basis_indices_intent = 0;
    PyObject *basis_indices_capi = Py_None;
    int *mask = NULL;
    npy_intp mask_Dims[2] = {-1, -1};
    const int mask_Rank = 2;
    PyArrayObject *capi_mask_as_array = NULL;
    int capi_mask_intent = 0;
    PyObject *mask_capi = Py_None;
    int *truncated = NULL;
    npy_intp truncated_Dims[2] = {-1, -1};
    const int truncated_Rank = 2;
    PyArrayObject *capi_truncated_as_array = NULL;
    int capi_truncated_intent = 0;
    PyObject *truncated_capi = Py_None;
    int *cov = NULL;
    npy_intp cov_Dims[2] = {-1, -1};
    const int cov_Rank = 2;
    PyArrayObject *capi_cov_as_array = NULL;
    int capi_cov_intent = 0;
    PyObject *cov_capi = Py_None;
    double *root = NULL;
    npy_intp root_Dims[2] = {-1, -1};
    const int root_Rank = 2;
    PyArrayObject *capi_root_as_array = NULL;
    int capi_root_intent = 0;
    PyObject *root_capi = Py_None;
    double *data_matrix_out = NULL;
    npy_intp data_matrix_out_Dims[2] = {-1, -1};
    const int data_matrix_out_Rank = 2;
    PyArrayObject *capi_data_matrix_out_as_array = NULL;
    int capi_data_matrix_out_intent = 0;
    double *data_matrix_mean = NULL;
    npy_intp data_matrix_mean_Dims[1] = {-1};
    const int data_matrix_mean_Rank = 1;
    PyArrayObject *capi_data_matrix_mean_as_array = NULL;
    int capi_data_matrix_mean_intent = 0;
    int f2py_x_d0 = 0;
    int f2py_x_d1 = 0;
    int f2py_basis_indices_d0 = 0;
    int f2py_mask_d0 = 0;
    int f2py_mask_d1 = 0;
    int f2py_truncated_d0 = 0;
    int f2py_truncated_d1 = 0;
    int f2py_cov_d0 = 0;
    int f2py_cov_d1 = 0;
    int f2py_root_d0 = 0;
    int f2py_root_d1 = 0;
    static char *capi_kwlist[] = {"x","basis_indices","mask","truncated","cov","root",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOO|:backend.backend.data_matrix",\
        capi_kwlist,&x_capi,&basis_indices_capi,&mask_capi,&truncated_capi,&cov_capi,&root_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable x */
    ;
    capi_x_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.data_matrix: failed to create array from the 1st argument `x`";
    capi_x_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,x_Dims,x_Rank,  capi_x_intent,x_capi,capi_errmess);
    if (capi_x_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        x = (double *)(PyArray_DATA(capi_x_as_array));

    /* Processing variable basis_indices */
    ;
    capi_basis_indices_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.data_matrix: failed to create array from the 2nd argument `basis_indices`";
    capi_basis_indices_as_array = ndarray_from_pyobj(  NPY_INT,1,basis_indices_Dims,basis_indices_Rank,  capi_basis_indices_intent,basis_indices_capi,capi_errmess);
    if (capi_basis_indices_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        basis_indices = (int *)(PyArray_DATA(capi_basis_indices_as_array));

    /* Processing variable mask */
    ;
    capi_mask_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.data_matrix: failed to create array from the 3rd argument `mask`";
    capi_mask_as_array = ndarray_from_pyobj(  NPY_INT,1,mask_Dims,mask_Rank,  capi_mask_intent,mask_capi,capi_errmess);
    if (capi_mask_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mask = (int *)(PyArray_DATA(capi_mask_as_array));

    /* Processing variable truncated */
    ;
    capi_truncated_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.data_matrix: failed to create array from the 4th argument `truncated`";
    capi_truncated_as_array = ndarray_from_pyobj(  NPY_INT,1,truncated_Dims,truncated_Rank,  capi_truncated_intent,truncated_capi,capi_errmess);
    if (capi_truncated_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        truncated = (int *)(PyArray_DATA(capi_truncated_as_array));

    /* Processing variable cov */
    ;
    capi_cov_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.data_matrix: failed to create array from the 5th argument `cov`";
    capi_cov_as_array = ndarray_from_pyobj(  NPY_INT,1,cov_Dims,cov_Rank,  capi_cov_intent,cov_capi,capi_errmess);
    if (capi_cov_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        cov = (int *)(PyArray_DATA(capi_cov_as_array));

    /* Processing variable root */
    ;
    capi_root_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.data_matrix: failed to create array from the 6th argument `root`";
    capi_root_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,root_Dims,root_Rank,  capi_root_intent,root_capi,capi_errmess);
    if (capi_root_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        root = (double *)(PyArray_DATA(capi_root_as_array));

    /* Processing variable data_matrix_out */
    data_matrix_out_Dims[0]=size(x, 1),data_matrix_out_Dims[1]=size(basis_indices);
    capi_data_matrix_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.data_matrix: failed to create array from the hidden `data_matrix_out`";
    capi_data_matrix_out_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_out_Dims,data_matrix_out_Rank,  capi_data_matrix_out_intent,Py_None,capi_errmess);
    if (capi_data_matrix_out_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_out = (double *)(PyArray_DATA(capi_data_matrix_out_as_array));

    /* Processing variable data_matrix_mean */
    data_matrix_mean_Dims[0]=size(basis_indices);
    capi_data_matrix_mean_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.data_matrix: failed to create array from the hidden `data_matrix_mean`";
    capi_data_matrix_mean_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_mean_Dims,data_matrix_mean_Rank,  capi_data_matrix_mean_intent,Py_None,capi_errmess);
    if (capi_data_matrix_mean_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_mean = (double *)(PyArray_DATA(capi_data_matrix_mean_as_array));

    /* Processing variable f2py_x_d0 */
    f2py_x_d0 = shape(x, 0);
    /* Processing variable f2py_x_d1 */
    f2py_x_d1 = shape(x, 1);
    /* Processing variable f2py_basis_indices_d0 */
    f2py_basis_indices_d0 = shape(basis_indices, 0);
    /* Processing variable f2py_mask_d0 */
    f2py_mask_d0 = shape(mask, 0);
    /* Processing variable f2py_mask_d1 */
    f2py_mask_d1 = shape(mask, 1);
    /* Processing variable f2py_truncated_d0 */
    f2py_truncated_d0 = shape(truncated, 0);
    /* Processing variable f2py_truncated_d1 */
    f2py_truncated_d1 = shape(truncated, 1);
    /* Processing variable f2py_cov_d0 */
    f2py_cov_d0 = shape(cov, 0);
    /* Processing variable f2py_cov_d1 */
    f2py_cov_d1 = shape(cov, 1);
    /* Processing variable f2py_root_d0 */
    f2py_root_d0 = shape(root, 0);
    /* Processing variable f2py_root_d1 */
    f2py_root_d1 = shape(root, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(x,basis_indices,mask,truncated,cov,root,data_matrix_out,data_matrix_mean,&f2py_x_d0,&f2py_x_d1,&f2py_basis_indices_d0,&f2py_mask_d0,&f2py_mask_d1,&f2py_truncated_d0,&f2py_truncated_d1,&f2py_cov_d0,&f2py_cov_d1,&f2py_root_d0,&f2py_root_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NN",capi_data_matrix_out_as_array,capi_data_matrix_mean_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_root_d1 */
    /* End of cleaning variable f2py_root_d0 */
    /* End of cleaning variable f2py_cov_d1 */
    /* End of cleaning variable f2py_cov_d0 */
    /* End of cleaning variable f2py_truncated_d1 */
    /* End of cleaning variable f2py_truncated_d0 */
    /* End of cleaning variable f2py_mask_d1 */
    /* End of cleaning variable f2py_mask_d0 */
    /* End of cleaning variable f2py_basis_indices_d0 */
    /* End of cleaning variable f2py_x_d1 */
    /* End of cleaning variable f2py_x_d0 */
    }  /* if (capi_data_matrix_mean_as_array == NULL) ... else of data_matrix_mean */
    /* End of cleaning variable data_matrix_mean */
    }  /* if (capi_data_matrix_out_as_array == NULL) ... else of data_matrix_out */
    /* End of cleaning variable data_matrix_out */
    if((PyObject *)capi_root_as_array!=root_capi) {
        Py_XDECREF(capi_root_as_array); }
    }  /* if (capi_root_as_array == NULL) ... else of root */
    /* End of cleaning variable root */
    if((PyObject *)capi_cov_as_array!=cov_capi) {
        Py_XDECREF(capi_cov_as_array); }
    }  /* if (capi_cov_as_array == NULL) ... else of cov */
    /* End of cleaning variable cov */
    if((PyObject *)capi_truncated_as_array!=truncated_capi) {
        Py_XDECREF(capi_truncated_as_array); }
    }  /* if (capi_truncated_as_array == NULL) ... else of truncated */
    /* End of cleaning variable truncated */
    if((PyObject *)capi_mask_as_array!=mask_capi) {
        Py_XDECREF(capi_mask_as_array); }
    }  /* if (capi_mask_as_array == NULL) ... else of mask */
    /* End of cleaning variable mask */
    if((PyObject *)capi_basis_indices_as_array!=basis_indices_capi) {
        Py_XDECREF(capi_basis_indices_as_array); }
    }  /* if (capi_basis_indices_as_array == NULL) ... else of basis_indices */
    /* End of cleaning variable basis_indices */
    if((PyObject *)capi_x_as_array!=x_capi) {
        Py_XDECREF(capi_x_as_array); }
    }  /* if (capi_x_as_array == NULL) ... else of x */
    /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of data_matrix *****************************/

/***************************** covariance_matrix *****************************/
static char doc_f2py_rout_backend_backend_covariance_matrix[] = "\
covariance_matrix_out = covariance_matrix(data_matrix)\n\nWrapper for ``covariance_matrix``.\
\n\nParameters\n----------\n"
"data_matrix : input rank-2 array('d') with bounds (f2py_data_matrix_d0,f2py_data_matrix_d1)\n"
"\nReturns\n-------\n"
"covariance_matrix_out : rank-2 array('d') with bounds (size(data_matrix, 2),size(data_matrix, 2))";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_covariance_matrix(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *data_matrix = NULL;
    npy_intp data_matrix_Dims[2] = {-1, -1};
    const int data_matrix_Rank = 2;
    PyArrayObject *capi_data_matrix_as_array = NULL;
    int capi_data_matrix_intent = 0;
    PyObject *data_matrix_capi = Py_None;
    double *covariance_matrix_out = NULL;
    npy_intp covariance_matrix_out_Dims[2] = {-1, -1};
    const int covariance_matrix_out_Rank = 2;
    PyArrayObject *capi_covariance_matrix_out_as_array = NULL;
    int capi_covariance_matrix_out_intent = 0;
    int f2py_data_matrix_d0 = 0;
    int f2py_data_matrix_d1 = 0;
    static char *capi_kwlist[] = {"data_matrix",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "O|:backend.backend.covariance_matrix",\
        capi_kwlist,&data_matrix_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable data_matrix */
    ;
    capi_data_matrix_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.covariance_matrix: failed to create array from the 1st argument `data_matrix`";
    capi_data_matrix_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_Dims,data_matrix_Rank,  capi_data_matrix_intent,data_matrix_capi,capi_errmess);
    if (capi_data_matrix_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix = (double *)(PyArray_DATA(capi_data_matrix_as_array));

    /* Processing variable covariance_matrix_out */
    covariance_matrix_out_Dims[0]=size(data_matrix, 2),covariance_matrix_out_Dims[1]=size(data_matrix, 2);
    capi_covariance_matrix_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.covariance_matrix: failed to create array from the hidden `covariance_matrix_out`";
    capi_covariance_matrix_out_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,covariance_matrix_out_Dims,covariance_matrix_out_Rank,  capi_covariance_matrix_out_intent,Py_None,capi_errmess);
    if (capi_covariance_matrix_out_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        covariance_matrix_out = (double *)(PyArray_DATA(capi_covariance_matrix_out_as_array));

    /* Processing variable f2py_data_matrix_d0 */
    f2py_data_matrix_d0 = shape(data_matrix, 0);
    /* Processing variable f2py_data_matrix_d1 */
    f2py_data_matrix_d1 = shape(data_matrix, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(data_matrix,covariance_matrix_out,&f2py_data_matrix_d0,&f2py_data_matrix_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_covariance_matrix_out_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_data_matrix_d1 */
    /* End of cleaning variable f2py_data_matrix_d0 */
    }  /* if (capi_covariance_matrix_out_as_array == NULL) ... else of covariance_matrix_out */
    /* End of cleaning variable covariance_matrix_out */
    if((PyObject *)capi_data_matrix_as_array!=data_matrix_capi) {
        Py_XDECREF(capi_data_matrix_as_array); }
    }  /* if (capi_data_matrix_as_array == NULL) ... else of data_matrix */
    /* End of cleaning variable data_matrix */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************** end of covariance_matrix **************************/

/************************************ rhs ************************************/
static char doc_f2py_rout_backend_backend_rhs[] = "\
rhs_out = rhs(y,y_mean,data_matrix_in)\n\nWrapper for ``rhs``.\
\n\nParameters\n----------\n"
"y : input rank-1 array('d') with bounds (f2py_y_d0)\n"
"y_mean : input float\n"
"data_matrix_in : input rank-2 array('d') with bounds (f2py_data_matrix_in_d0,f2py_data_matrix_in_d1)\n"
"\nReturns\n-------\n"
"rhs_out : rank-1 array('d') with bounds (size(data_matrix_in, 2))";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_rhs(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *y = NULL;
    npy_intp y_Dims[1] = {-1};
    const int y_Rank = 1;
    PyArrayObject *capi_y_as_array = NULL;
    int capi_y_intent = 0;
    PyObject *y_capi = Py_None;
    double y_mean = 0;
    PyObject *y_mean_capi = Py_None;
    double *data_matrix_in = NULL;
    npy_intp data_matrix_in_Dims[2] = {-1, -1};
    const int data_matrix_in_Rank = 2;
    PyArrayObject *capi_data_matrix_in_as_array = NULL;
    int capi_data_matrix_in_intent = 0;
    PyObject *data_matrix_in_capi = Py_None;
    double *rhs_out = NULL;
    npy_intp rhs_out_Dims[1] = {-1};
    const int rhs_out_Rank = 1;
    PyArrayObject *capi_rhs_out_as_array = NULL;
    int capi_rhs_out_intent = 0;
    int f2py_y_d0 = 0;
    int f2py_data_matrix_in_d0 = 0;
    int f2py_data_matrix_in_d1 = 0;
    static char *capi_kwlist[] = {"y","y_mean","data_matrix_in",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|:backend.backend.rhs",\
        capi_kwlist,&y_capi,&y_mean_capi,&data_matrix_in_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable y */
    ;
    capi_y_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.rhs: failed to create array from the 1st argument `y`";
    capi_y_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,y_Dims,y_Rank,  capi_y_intent,y_capi,capi_errmess);
    if (capi_y_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        y = (double *)(PyArray_DATA(capi_y_as_array));

    /* Processing variable y_mean */
        f2py_success = double_from_pyobj(&y_mean,y_mean_capi,"backend.backend.rhs() 2nd argument (y_mean) can't be converted to double");
    if (f2py_success) {
    /* Processing variable data_matrix_in */
    ;
    capi_data_matrix_in_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.rhs: failed to create array from the 3rd argument `data_matrix_in`";
    capi_data_matrix_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_in_Dims,data_matrix_in_Rank,  capi_data_matrix_in_intent,data_matrix_in_capi,capi_errmess);
    if (capi_data_matrix_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_in = (double *)(PyArray_DATA(capi_data_matrix_in_as_array));

    /* Processing variable rhs_out */
    rhs_out_Dims[0]=size(data_matrix_in, 2);
    capi_rhs_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.rhs: failed to create array from the hidden `rhs_out`";
    capi_rhs_out_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rhs_out_Dims,rhs_out_Rank,  capi_rhs_out_intent,Py_None,capi_errmess);
    if (capi_rhs_out_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rhs_out = (double *)(PyArray_DATA(capi_rhs_out_as_array));

    /* Processing variable f2py_y_d0 */
    f2py_y_d0 = shape(y, 0);
    /* Processing variable f2py_data_matrix_in_d0 */
    f2py_data_matrix_in_d0 = shape(data_matrix_in, 0);
    /* Processing variable f2py_data_matrix_in_d1 */
    f2py_data_matrix_in_d1 = shape(data_matrix_in, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(y,&y_mean,data_matrix_in,rhs_out,&f2py_y_d0,&f2py_data_matrix_in_d0,&f2py_data_matrix_in_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_rhs_out_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_data_matrix_in_d1 */
    /* End of cleaning variable f2py_data_matrix_in_d0 */
    /* End of cleaning variable f2py_y_d0 */
    }  /* if (capi_rhs_out_as_array == NULL) ... else of rhs_out */
    /* End of cleaning variable rhs_out */
    if((PyObject *)capi_data_matrix_in_as_array!=data_matrix_in_capi) {
        Py_XDECREF(capi_data_matrix_in_as_array); }
    }  /* if (capi_data_matrix_in_as_array == NULL) ... else of data_matrix_in */
    /* End of cleaning variable data_matrix_in */
    } /*if (f2py_success) of y_mean*/
    /* End of cleaning variable y_mean */
    if((PyObject *)capi_y_as_array!=y_capi) {
        Py_XDECREF(capi_y_as_array); }
    }  /* if (capi_y_as_array == NULL) ... else of y */
    /* End of cleaning variable y */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************************* end of rhs *********************************/

/******************************** coefficients ********************************/
static char doc_f2py_rout_backend_backend_coefficients[] = "\
coefficients_out,chol = coefficients(covariance_matrix,rhs)\n\nWrapper for ``coefficients``.\
\n\nParameters\n----------\n"
"covariance_matrix : input rank-2 array('d') with bounds (f2py_covariance_matrix_d0,f2py_covariance_matrix_d1)\n"
"rhs : input rank-1 array('d') with bounds (f2py_rhs_d0)\n"
"\nReturns\n-------\n"
"coefficients_out : rank-1 array('d') with bounds (size(rhs))\n"
"chol : rank-2 array('d') with bounds (size(covariance_matrix, 1),size(covariance_matrix, 2))";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_coefficients(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *covariance_matrix = NULL;
    npy_intp covariance_matrix_Dims[2] = {-1, -1};
    const int covariance_matrix_Rank = 2;
    PyArrayObject *capi_covariance_matrix_as_array = NULL;
    int capi_covariance_matrix_intent = 0;
    PyObject *covariance_matrix_capi = Py_None;
    double *rhs = NULL;
    npy_intp rhs_Dims[1] = {-1};
    const int rhs_Rank = 1;
    PyArrayObject *capi_rhs_as_array = NULL;
    int capi_rhs_intent = 0;
    PyObject *rhs_capi = Py_None;
    double *coefficients_out = NULL;
    npy_intp coefficients_out_Dims[1] = {-1};
    const int coefficients_out_Rank = 1;
    PyArrayObject *capi_coefficients_out_as_array = NULL;
    int capi_coefficients_out_intent = 0;
    double *chol = NULL;
    npy_intp chol_Dims[2] = {-1, -1};
    const int chol_Rank = 2;
    PyArrayObject *capi_chol_as_array = NULL;
    int capi_chol_intent = 0;
    int f2py_covariance_matrix_d0 = 0;
    int f2py_covariance_matrix_d1 = 0;
    int f2py_rhs_d0 = 0;
    static char *capi_kwlist[] = {"covariance_matrix","rhs",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:backend.backend.coefficients",\
        capi_kwlist,&covariance_matrix_capi,&rhs_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable covariance_matrix */
    ;
    capi_covariance_matrix_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.coefficients: failed to create array from the 1st argument `covariance_matrix`";
    capi_covariance_matrix_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,covariance_matrix_Dims,covariance_matrix_Rank,  capi_covariance_matrix_intent,covariance_matrix_capi,capi_errmess);
    if (capi_covariance_matrix_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        covariance_matrix = (double *)(PyArray_DATA(capi_covariance_matrix_as_array));

    /* Processing variable rhs */
    ;
    capi_rhs_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.coefficients: failed to create array from the 2nd argument `rhs`";
    capi_rhs_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rhs_Dims,rhs_Rank,  capi_rhs_intent,rhs_capi,capi_errmess);
    if (capi_rhs_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rhs = (double *)(PyArray_DATA(capi_rhs_as_array));

    /* Processing variable coefficients_out */
    coefficients_out_Dims[0]=size(rhs);
    capi_coefficients_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.coefficients: failed to create array from the hidden `coefficients_out`";
    capi_coefficients_out_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,coefficients_out_Dims,coefficients_out_Rank,  capi_coefficients_out_intent,Py_None,capi_errmess);
    if (capi_coefficients_out_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        coefficients_out = (double *)(PyArray_DATA(capi_coefficients_out_as_array));

    /* Processing variable chol */
    chol_Dims[0]=size(covariance_matrix, 1),chol_Dims[1]=size(covariance_matrix, 2);
    capi_chol_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.coefficients: failed to create array from the hidden `chol`";
    capi_chol_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,chol_Dims,chol_Rank,  capi_chol_intent,Py_None,capi_errmess);
    if (capi_chol_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        chol = (double *)(PyArray_DATA(capi_chol_as_array));

    /* Processing variable f2py_covariance_matrix_d0 */
    f2py_covariance_matrix_d0 = shape(covariance_matrix, 0);
    /* Processing variable f2py_covariance_matrix_d1 */
    f2py_covariance_matrix_d1 = shape(covariance_matrix, 1);
    /* Processing variable f2py_rhs_d0 */
    f2py_rhs_d0 = shape(rhs, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(covariance_matrix,rhs,coefficients_out,chol,&f2py_covariance_matrix_d0,&f2py_covariance_matrix_d1,&f2py_rhs_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NN",capi_coefficients_out_as_array,capi_chol_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_rhs_d0 */
    /* End of cleaning variable f2py_covariance_matrix_d1 */
    /* End of cleaning variable f2py_covariance_matrix_d0 */
    }  /* if (capi_chol_as_array == NULL) ... else of chol */
    /* End of cleaning variable chol */
    }  /* if (capi_coefficients_out_as_array == NULL) ... else of coefficients_out */
    /* End of cleaning variable coefficients_out */
    if((PyObject *)capi_rhs_as_array!=rhs_capi) {
        Py_XDECREF(capi_rhs_as_array); }
    }  /* if (capi_rhs_as_array == NULL) ... else of rhs */
    /* End of cleaning variable rhs */
    if((PyObject *)capi_covariance_matrix_as_array!=covariance_matrix_capi) {
        Py_XDECREF(capi_covariance_matrix_as_array); }
    }  /* if (capi_covariance_matrix_as_array == NULL) ... else of covariance_matrix */
    /* End of cleaning variable covariance_matrix */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************************** end of coefficients ****************************/

/************************ generalised_cross_validation ************************/
static char doc_f2py_rout_backend_backend_generalised_cross_validation[] = "\
lof = generalised_cross_validation(y,y_mean,data_matrix_in,chol,coefficients_in,penalty)\n\nWrapper for ``generalised_cross_validation``.\
\n\nParameters\n----------\n"
"y : input rank-1 array('d') with bounds (f2py_y_d0)\n"
"y_mean : input float\n"
"data_matrix_in : input rank-2 array('d') with bounds (f2py_data_matrix_in_d0,f2py_data_matrix_in_d1)\n"
"chol : input rank-2 array('d') with bounds (f2py_chol_d0,f2py_chol_d1)\n"
"coefficients_in : input rank-1 array('d') with bounds (f2py_coefficients_in_d0)\n"
"penalty : input int\n"
"\nReturns\n-------\n"
"lof : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_generalised_cross_validation(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,double*,int*,double*,int*,int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *y = NULL;
    npy_intp y_Dims[1] = {-1};
    const int y_Rank = 1;
    PyArrayObject *capi_y_as_array = NULL;
    int capi_y_intent = 0;
    PyObject *y_capi = Py_None;
    double y_mean = 0;
    PyObject *y_mean_capi = Py_None;
    double *data_matrix_in = NULL;
    npy_intp data_matrix_in_Dims[2] = {-1, -1};
    const int data_matrix_in_Rank = 2;
    PyArrayObject *capi_data_matrix_in_as_array = NULL;
    int capi_data_matrix_in_intent = 0;
    PyObject *data_matrix_in_capi = Py_None;
    double *chol = NULL;
    npy_intp chol_Dims[2] = {-1, -1};
    const int chol_Rank = 2;
    PyArrayObject *capi_chol_as_array = NULL;
    int capi_chol_intent = 0;
    PyObject *chol_capi = Py_None;
    double *coefficients_in = NULL;
    npy_intp coefficients_in_Dims[1] = {-1};
    const int coefficients_in_Rank = 1;
    PyArrayObject *capi_coefficients_in_as_array = NULL;
    int capi_coefficients_in_intent = 0;
    PyObject *coefficients_in_capi = Py_None;
    int penalty = 0;
    PyObject *penalty_capi = Py_None;
    double lof = 0;
    int f2py_y_d0 = 0;
    int f2py_data_matrix_in_d0 = 0;
    int f2py_data_matrix_in_d1 = 0;
    int f2py_chol_d0 = 0;
    int f2py_chol_d1 = 0;
    int f2py_coefficients_in_d0 = 0;
    static char *capi_kwlist[] = {"y","y_mean","data_matrix_in","chol","coefficients_in","penalty",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOO|:backend.backend.generalised_cross_validation",\
        capi_kwlist,&y_capi,&y_mean_capi,&data_matrix_in_capi,&chol_capi,&coefficients_in_capi,&penalty_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable y */
    ;
    capi_y_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.generalised_cross_validation: failed to create array from the 1st argument `y`";
    capi_y_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,y_Dims,y_Rank,  capi_y_intent,y_capi,capi_errmess);
    if (capi_y_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        y = (double *)(PyArray_DATA(capi_y_as_array));

    /* Processing variable y_mean */
        f2py_success = double_from_pyobj(&y_mean,y_mean_capi,"backend.backend.generalised_cross_validation() 2nd argument (y_mean) can't be converted to double");
    if (f2py_success) {
    /* Processing variable data_matrix_in */
    ;
    capi_data_matrix_in_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.generalised_cross_validation: failed to create array from the 3rd argument `data_matrix_in`";
    capi_data_matrix_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_in_Dims,data_matrix_in_Rank,  capi_data_matrix_in_intent,data_matrix_in_capi,capi_errmess);
    if (capi_data_matrix_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_in = (double *)(PyArray_DATA(capi_data_matrix_in_as_array));

    /* Processing variable chol */
    ;
    capi_chol_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.generalised_cross_validation: failed to create array from the 4th argument `chol`";
    capi_chol_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,chol_Dims,chol_Rank,  capi_chol_intent,chol_capi,capi_errmess);
    if (capi_chol_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        chol = (double *)(PyArray_DATA(capi_chol_as_array));

    /* Processing variable coefficients_in */
    ;
    capi_coefficients_in_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.generalised_cross_validation: failed to create array from the 5th argument `coefficients_in`";
    capi_coefficients_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,coefficients_in_Dims,coefficients_in_Rank,  capi_coefficients_in_intent,coefficients_in_capi,capi_errmess);
    if (capi_coefficients_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        coefficients_in = (double *)(PyArray_DATA(capi_coefficients_in_as_array));

    /* Processing variable penalty */
        f2py_success = int_from_pyobj(&penalty,penalty_capi,"backend.backend.generalised_cross_validation() 6th argument (penalty) can't be converted to int");
    if (f2py_success) {
    /* Processing variable lof */
    /* Processing variable f2py_y_d0 */
    f2py_y_d0 = shape(y, 0);
    /* Processing variable f2py_data_matrix_in_d0 */
    f2py_data_matrix_in_d0 = shape(data_matrix_in, 0);
    /* Processing variable f2py_data_matrix_in_d1 */
    f2py_data_matrix_in_d1 = shape(data_matrix_in, 1);
    /* Processing variable f2py_chol_d0 */
    f2py_chol_d0 = shape(chol, 0);
    /* Processing variable f2py_chol_d1 */
    f2py_chol_d1 = shape(chol, 1);
    /* Processing variable f2py_coefficients_in_d0 */
    f2py_coefficients_in_d0 = shape(coefficients_in, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(y,&y_mean,data_matrix_in,chol,coefficients_in,&penalty,&lof,&f2py_y_d0,&f2py_data_matrix_in_d0,&f2py_data_matrix_in_d1,&f2py_chol_d0,&f2py_chol_d1,&f2py_coefficients_in_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("d",lof);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_coefficients_in_d0 */
    /* End of cleaning variable f2py_chol_d1 */
    /* End of cleaning variable f2py_chol_d0 */
    /* End of cleaning variable f2py_data_matrix_in_d1 */
    /* End of cleaning variable f2py_data_matrix_in_d0 */
    /* End of cleaning variable f2py_y_d0 */
    /* End of cleaning variable lof */
    } /*if (f2py_success) of penalty*/
    /* End of cleaning variable penalty */
    if((PyObject *)capi_coefficients_in_as_array!=coefficients_in_capi) {
        Py_XDECREF(capi_coefficients_in_as_array); }
    }  /* if (capi_coefficients_in_as_array == NULL) ... else of coefficients_in */
    /* End of cleaning variable coefficients_in */
    if((PyObject *)capi_chol_as_array!=chol_capi) {
        Py_XDECREF(capi_chol_as_array); }
    }  /* if (capi_chol_as_array == NULL) ... else of chol */
    /* End of cleaning variable chol */
    if((PyObject *)capi_data_matrix_in_as_array!=data_matrix_in_capi) {
        Py_XDECREF(capi_data_matrix_in_as_array); }
    }  /* if (capi_data_matrix_in_as_array == NULL) ... else of data_matrix_in */
    /* End of cleaning variable data_matrix_in */
    } /*if (f2py_success) of y_mean*/
    /* End of cleaning variable y_mean */
    if((PyObject *)capi_y_as_array!=y_capi) {
        Py_XDECREF(capi_y_as_array); }
    }  /* if (capi_y_as_array == NULL) ... else of y */
    /* End of cleaning variable y */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************** end of generalised_cross_validation ********************/

/************************************ fit ************************************/
static char doc_f2py_rout_backend_backend_fit[] = "\
data_matrix_out,data_matrix_mean,covariance_matrix_out,rhs_out,chol,coefficients_out,lof = fit(x,y,y_mean,nbases,mask,truncated,cov,root,penalty)\n\nWrapper for ``fit``.\
\n\nParameters\n----------\n"
"x : input rank-2 array('d') with bounds (f2py_x_d0,f2py_x_d1)\n"
"y : input rank-1 array('d') with bounds (f2py_y_d0)\n"
"y_mean : input float\n"
"nbases : input int\n"
"mask : input rank-2 array('i') with bounds (f2py_mask_d0,f2py_mask_d1)\n"
"truncated : input rank-2 array('i') with bounds (f2py_truncated_d0,f2py_truncated_d1)\n"
"cov : input rank-2 array('i') with bounds (f2py_cov_d0,f2py_cov_d1)\n"
"root : input rank-2 array('d') with bounds (f2py_root_d0,f2py_root_d1)\n"
"penalty : input int\n"
"\nReturns\n-------\n"
"data_matrix_out : rank-2 array('d') with bounds (size(x, 1),-1 + nbases)\n"
"data_matrix_mean : rank-1 array('d') with bounds (-1 + nbases)\n"
"covariance_matrix_out : rank-2 array('d') with bounds (-1 + nbases,-1 + nbases)\n"
"rhs_out : rank-1 array('d') with bounds (-1 + nbases)\n"
"chol : rank-2 array('d') with bounds (-1 + nbases,-1 + nbases)\n"
"coefficients_out : rank-1 array('d') with bounds (-1 + nbases)\n"
"lof : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_fit(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,int*,int*,int*,double*,int*,double*,double*,double*,double*,double*,double*,double*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *x = NULL;
    npy_intp x_Dims[2] = {-1, -1};
    const int x_Rank = 2;
    PyArrayObject *capi_x_as_array = NULL;
    int capi_x_intent = 0;
    PyObject *x_capi = Py_None;
    double *y = NULL;
    npy_intp y_Dims[1] = {-1};
    const int y_Rank = 1;
    PyArrayObject *capi_y_as_array = NULL;
    int capi_y_intent = 0;
    PyObject *y_capi = Py_None;
    double y_mean = 0;
    PyObject *y_mean_capi = Py_None;
    int nbases = 0;
    PyObject *nbases_capi = Py_None;
    int *mask = NULL;
    npy_intp mask_Dims[2] = {-1, -1};
    const int mask_Rank = 2;
    PyArrayObject *capi_mask_as_array = NULL;
    int capi_mask_intent = 0;
    PyObject *mask_capi = Py_None;
    int *truncated = NULL;
    npy_intp truncated_Dims[2] = {-1, -1};
    const int truncated_Rank = 2;
    PyArrayObject *capi_truncated_as_array = NULL;
    int capi_truncated_intent = 0;
    PyObject *truncated_capi = Py_None;
    int *cov = NULL;
    npy_intp cov_Dims[2] = {-1, -1};
    const int cov_Rank = 2;
    PyArrayObject *capi_cov_as_array = NULL;
    int capi_cov_intent = 0;
    PyObject *cov_capi = Py_None;
    double *root = NULL;
    npy_intp root_Dims[2] = {-1, -1};
    const int root_Rank = 2;
    PyArrayObject *capi_root_as_array = NULL;
    int capi_root_intent = 0;
    PyObject *root_capi = Py_None;
    int penalty = 0;
    PyObject *penalty_capi = Py_None;
    double *data_matrix_out = NULL;
    npy_intp data_matrix_out_Dims[2] = {-1, -1};
    const int data_matrix_out_Rank = 2;
    PyArrayObject *capi_data_matrix_out_as_array = NULL;
    int capi_data_matrix_out_intent = 0;
    double *data_matrix_mean = NULL;
    npy_intp data_matrix_mean_Dims[1] = {-1};
    const int data_matrix_mean_Rank = 1;
    PyArrayObject *capi_data_matrix_mean_as_array = NULL;
    int capi_data_matrix_mean_intent = 0;
    double *covariance_matrix_out = NULL;
    npy_intp covariance_matrix_out_Dims[2] = {-1, -1};
    const int covariance_matrix_out_Rank = 2;
    PyArrayObject *capi_covariance_matrix_out_as_array = NULL;
    int capi_covariance_matrix_out_intent = 0;
    double *rhs_out = NULL;
    npy_intp rhs_out_Dims[1] = {-1};
    const int rhs_out_Rank = 1;
    PyArrayObject *capi_rhs_out_as_array = NULL;
    int capi_rhs_out_intent = 0;
    double *chol = NULL;
    npy_intp chol_Dims[2] = {-1, -1};
    const int chol_Rank = 2;
    PyArrayObject *capi_chol_as_array = NULL;
    int capi_chol_intent = 0;
    double *coefficients_out = NULL;
    npy_intp coefficients_out_Dims[1] = {-1};
    const int coefficients_out_Rank = 1;
    PyArrayObject *capi_coefficients_out_as_array = NULL;
    int capi_coefficients_out_intent = 0;
    double lof = 0;
    int f2py_x_d0 = 0;
    int f2py_x_d1 = 0;
    int f2py_y_d0 = 0;
    int f2py_mask_d0 = 0;
    int f2py_mask_d1 = 0;
    int f2py_truncated_d0 = 0;
    int f2py_truncated_d1 = 0;
    int f2py_cov_d0 = 0;
    int f2py_cov_d1 = 0;
    int f2py_root_d0 = 0;
    int f2py_root_d1 = 0;
    static char *capi_kwlist[] = {"x","y","y_mean","nbases","mask","truncated","cov","root","penalty",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOO|:backend.backend.fit",\
        capi_kwlist,&x_capi,&y_capi,&y_mean_capi,&nbases_capi,&mask_capi,&truncated_capi,&cov_capi,&root_capi,&penalty_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable x */
    ;
    capi_x_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.fit: failed to create array from the 1st argument `x`";
    capi_x_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,x_Dims,x_Rank,  capi_x_intent,x_capi,capi_errmess);
    if (capi_x_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        x = (double *)(PyArray_DATA(capi_x_as_array));

    /* Processing variable y */
    ;
    capi_y_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.fit: failed to create array from the 2nd argument `y`";
    capi_y_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,y_Dims,y_Rank,  capi_y_intent,y_capi,capi_errmess);
    if (capi_y_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        y = (double *)(PyArray_DATA(capi_y_as_array));

    /* Processing variable y_mean */
        f2py_success = double_from_pyobj(&y_mean,y_mean_capi,"backend.backend.fit() 3rd argument (y_mean) can't be converted to double");
    if (f2py_success) {
    /* Processing variable nbases */
        f2py_success = int_from_pyobj(&nbases,nbases_capi,"backend.backend.fit() 4th argument (nbases) can't be converted to int");
    if (f2py_success) {
    /* Processing variable mask */
    ;
    capi_mask_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.fit: failed to create array from the 5th argument `mask`";
    capi_mask_as_array = ndarray_from_pyobj(  NPY_INT,1,mask_Dims,mask_Rank,  capi_mask_intent,mask_capi,capi_errmess);
    if (capi_mask_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mask = (int *)(PyArray_DATA(capi_mask_as_array));

    /* Processing variable truncated */
    ;
    capi_truncated_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.fit: failed to create array from the 6th argument `truncated`";
    capi_truncated_as_array = ndarray_from_pyobj(  NPY_INT,1,truncated_Dims,truncated_Rank,  capi_truncated_intent,truncated_capi,capi_errmess);
    if (capi_truncated_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        truncated = (int *)(PyArray_DATA(capi_truncated_as_array));

    /* Processing variable cov */
    ;
    capi_cov_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.fit: failed to create array from the 7th argument `cov`";
    capi_cov_as_array = ndarray_from_pyobj(  NPY_INT,1,cov_Dims,cov_Rank,  capi_cov_intent,cov_capi,capi_errmess);
    if (capi_cov_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        cov = (int *)(PyArray_DATA(capi_cov_as_array));

    /* Processing variable root */
    ;
    capi_root_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.fit: failed to create array from the 8th argument `root`";
    capi_root_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,root_Dims,root_Rank,  capi_root_intent,root_capi,capi_errmess);
    if (capi_root_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        root = (double *)(PyArray_DATA(capi_root_as_array));

    /* Processing variable penalty */
        f2py_success = int_from_pyobj(&penalty,penalty_capi,"backend.backend.fit() 9th argument (penalty) can't be converted to int");
    if (f2py_success) {
    /* Processing variable lof */
    /* Processing variable data_matrix_out */
    data_matrix_out_Dims[0]=size(x, 1),data_matrix_out_Dims[1]=-1 + nbases;
    capi_data_matrix_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.fit: failed to create array from the hidden `data_matrix_out`";
    capi_data_matrix_out_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_out_Dims,data_matrix_out_Rank,  capi_data_matrix_out_intent,Py_None,capi_errmess);
    if (capi_data_matrix_out_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_out = (double *)(PyArray_DATA(capi_data_matrix_out_as_array));

    /* Processing variable data_matrix_mean */
    data_matrix_mean_Dims[0]=-1 + nbases;
    capi_data_matrix_mean_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.fit: failed to create array from the hidden `data_matrix_mean`";
    capi_data_matrix_mean_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_mean_Dims,data_matrix_mean_Rank,  capi_data_matrix_mean_intent,Py_None,capi_errmess);
    if (capi_data_matrix_mean_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_mean = (double *)(PyArray_DATA(capi_data_matrix_mean_as_array));

    /* Processing variable covariance_matrix_out */
    covariance_matrix_out_Dims[0]=-1 + nbases,covariance_matrix_out_Dims[1]=-1 + nbases;
    capi_covariance_matrix_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.fit: failed to create array from the hidden `covariance_matrix_out`";
    capi_covariance_matrix_out_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,covariance_matrix_out_Dims,covariance_matrix_out_Rank,  capi_covariance_matrix_out_intent,Py_None,capi_errmess);
    if (capi_covariance_matrix_out_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        covariance_matrix_out = (double *)(PyArray_DATA(capi_covariance_matrix_out_as_array));

    /* Processing variable rhs_out */
    rhs_out_Dims[0]=-1 + nbases;
    capi_rhs_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.fit: failed to create array from the hidden `rhs_out`";
    capi_rhs_out_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rhs_out_Dims,rhs_out_Rank,  capi_rhs_out_intent,Py_None,capi_errmess);
    if (capi_rhs_out_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rhs_out = (double *)(PyArray_DATA(capi_rhs_out_as_array));

    /* Processing variable chol */
    chol_Dims[0]=-1 + nbases,chol_Dims[1]=-1 + nbases;
    capi_chol_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.fit: failed to create array from the hidden `chol`";
    capi_chol_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,chol_Dims,chol_Rank,  capi_chol_intent,Py_None,capi_errmess);
    if (capi_chol_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        chol = (double *)(PyArray_DATA(capi_chol_as_array));

    /* Processing variable coefficients_out */
    coefficients_out_Dims[0]=-1 + nbases;
    capi_coefficients_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.fit: failed to create array from the hidden `coefficients_out`";
    capi_coefficients_out_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,coefficients_out_Dims,coefficients_out_Rank,  capi_coefficients_out_intent,Py_None,capi_errmess);
    if (capi_coefficients_out_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        coefficients_out = (double *)(PyArray_DATA(capi_coefficients_out_as_array));

    /* Processing variable f2py_x_d0 */
    f2py_x_d0 = shape(x, 0);
    /* Processing variable f2py_x_d1 */
    f2py_x_d1 = shape(x, 1);
    /* Processing variable f2py_y_d0 */
    f2py_y_d0 = shape(y, 0);
    /* Processing variable f2py_mask_d0 */
    f2py_mask_d0 = shape(mask, 0);
    /* Processing variable f2py_mask_d1 */
    f2py_mask_d1 = shape(mask, 1);
    /* Processing variable f2py_truncated_d0 */
    f2py_truncated_d0 = shape(truncated, 0);
    /* Processing variable f2py_truncated_d1 */
    f2py_truncated_d1 = shape(truncated, 1);
    /* Processing variable f2py_cov_d0 */
    f2py_cov_d0 = shape(cov, 0);
    /* Processing variable f2py_cov_d1 */
    f2py_cov_d1 = shape(cov, 1);
    /* Processing variable f2py_root_d0 */
    f2py_root_d0 = shape(root, 0);
    /* Processing variable f2py_root_d1 */
    f2py_root_d1 = shape(root, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(x,y,&y_mean,&nbases,mask,truncated,cov,root,&penalty,data_matrix_out,data_matrix_mean,covariance_matrix_out,rhs_out,chol,coefficients_out,&lof,&f2py_x_d0,&f2py_x_d1,&f2py_y_d0,&f2py_mask_d0,&f2py_mask_d1,&f2py_truncated_d0,&f2py_truncated_d1,&f2py_cov_d0,&f2py_cov_d1,&f2py_root_d0,&f2py_root_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NNNNNNd",capi_data_matrix_out_as_array,capi_data_matrix_mean_as_array,capi_covariance_matrix_out_as_array,capi_rhs_out_as_array,capi_chol_as_array,capi_coefficients_out_as_array,lof);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_root_d1 */
    /* End of cleaning variable f2py_root_d0 */
    /* End of cleaning variable f2py_cov_d1 */
    /* End of cleaning variable f2py_cov_d0 */
    /* End of cleaning variable f2py_truncated_d1 */
    /* End of cleaning variable f2py_truncated_d0 */
    /* End of cleaning variable f2py_mask_d1 */
    /* End of cleaning variable f2py_mask_d0 */
    /* End of cleaning variable f2py_y_d0 */
    /* End of cleaning variable f2py_x_d1 */
    /* End of cleaning variable f2py_x_d0 */
    }  /* if (capi_coefficients_out_as_array == NULL) ... else of coefficients_out */
    /* End of cleaning variable coefficients_out */
    }  /* if (capi_chol_as_array == NULL) ... else of chol */
    /* End of cleaning variable chol */
    }  /* if (capi_rhs_out_as_array == NULL) ... else of rhs_out */
    /* End of cleaning variable rhs_out */
    }  /* if (capi_covariance_matrix_out_as_array == NULL) ... else of covariance_matrix_out */
    /* End of cleaning variable covariance_matrix_out */
    }  /* if (capi_data_matrix_mean_as_array == NULL) ... else of data_matrix_mean */
    /* End of cleaning variable data_matrix_mean */
    }  /* if (capi_data_matrix_out_as_array == NULL) ... else of data_matrix_out */
    /* End of cleaning variable data_matrix_out */
    /* End of cleaning variable lof */
    } /*if (f2py_success) of penalty*/
    /* End of cleaning variable penalty */
    if((PyObject *)capi_root_as_array!=root_capi) {
        Py_XDECREF(capi_root_as_array); }
    }  /* if (capi_root_as_array == NULL) ... else of root */
    /* End of cleaning variable root */
    if((PyObject *)capi_cov_as_array!=cov_capi) {
        Py_XDECREF(capi_cov_as_array); }
    }  /* if (capi_cov_as_array == NULL) ... else of cov */
    /* End of cleaning variable cov */
    if((PyObject *)capi_truncated_as_array!=truncated_capi) {
        Py_XDECREF(capi_truncated_as_array); }
    }  /* if (capi_truncated_as_array == NULL) ... else of truncated */
    /* End of cleaning variable truncated */
    if((PyObject *)capi_mask_as_array!=mask_capi) {
        Py_XDECREF(capi_mask_as_array); }
    }  /* if (capi_mask_as_array == NULL) ... else of mask */
    /* End of cleaning variable mask */
    } /*if (f2py_success) of nbases*/
    /* End of cleaning variable nbases */
    } /*if (f2py_success) of y_mean*/
    /* End of cleaning variable y_mean */
    if((PyObject *)capi_y_as_array!=y_capi) {
        Py_XDECREF(capi_y_as_array); }
    }  /* if (capi_y_as_array == NULL) ... else of y */
    /* End of cleaning variable y */
    if((PyObject *)capi_x_as_array!=x_capi) {
        Py_XDECREF(capi_x_as_array); }
    }  /* if (capi_x_as_array == NULL) ... else of x */
    /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************************* end of fit *********************************/

/******************************** update_init ********************************/
static char doc_f2py_rout_backend_backend_update_init[] = "\
update,update_mean = update_init(x,data_matrix_in,data_matrix_mean,prev_root,parent_idx,nbases,mask,cov,root)\n\nWrapper for ``update_init``.\
\n\nParameters\n----------\n"
"x : input rank-2 array('d') with bounds (f2py_x_d0,f2py_x_d1)\n"
"data_matrix_in : input rank-2 array('d') with bounds (f2py_data_matrix_in_d0,f2py_data_matrix_in_d1)\n"
"data_matrix_mean : input rank-1 array('d') with bounds (f2py_data_matrix_mean_d0)\n"
"prev_root : input float\n"
"parent_idx : input int\n"
"nbases : input int\n"
"mask : input rank-2 array('i') with bounds (f2py_mask_d0,f2py_mask_d1)\n"
"cov : input rank-2 array('i') with bounds (f2py_cov_d0,f2py_cov_d1)\n"
"root : input rank-2 array('d') with bounds (f2py_root_d0,f2py_root_d1)\n"
"\nReturns\n-------\n"
"update : rank-1 array('d') with bounds (size(data_matrix_in, 1))\n"
"update_mean : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_update_init(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,int*,int*,int*,double*,double*,double*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *x = NULL;
    npy_intp x_Dims[2] = {-1, -1};
    const int x_Rank = 2;
    PyArrayObject *capi_x_as_array = NULL;
    int capi_x_intent = 0;
    PyObject *x_capi = Py_None;
    double *data_matrix_in = NULL;
    npy_intp data_matrix_in_Dims[2] = {-1, -1};
    const int data_matrix_in_Rank = 2;
    PyArrayObject *capi_data_matrix_in_as_array = NULL;
    int capi_data_matrix_in_intent = 0;
    PyObject *data_matrix_in_capi = Py_None;
    double *data_matrix_mean = NULL;
    npy_intp data_matrix_mean_Dims[1] = {-1};
    const int data_matrix_mean_Rank = 1;
    PyArrayObject *capi_data_matrix_mean_as_array = NULL;
    int capi_data_matrix_mean_intent = 0;
    PyObject *data_matrix_mean_capi = Py_None;
    double prev_root = 0;
    PyObject *prev_root_capi = Py_None;
    int parent_idx = 0;
    PyObject *parent_idx_capi = Py_None;
    int nbases = 0;
    PyObject *nbases_capi = Py_None;
    int *mask = NULL;
    npy_intp mask_Dims[2] = {-1, -1};
    const int mask_Rank = 2;
    PyArrayObject *capi_mask_as_array = NULL;
    int capi_mask_intent = 0;
    PyObject *mask_capi = Py_None;
    int *cov = NULL;
    npy_intp cov_Dims[2] = {-1, -1};
    const int cov_Rank = 2;
    PyArrayObject *capi_cov_as_array = NULL;
    int capi_cov_intent = 0;
    PyObject *cov_capi = Py_None;
    double *root = NULL;
    npy_intp root_Dims[2] = {-1, -1};
    const int root_Rank = 2;
    PyArrayObject *capi_root_as_array = NULL;
    int capi_root_intent = 0;
    PyObject *root_capi = Py_None;
    double *update = NULL;
    npy_intp update_Dims[1] = {-1};
    const int update_Rank = 1;
    PyArrayObject *capi_update_as_array = NULL;
    int capi_update_intent = 0;
    double update_mean = 0;
    int f2py_x_d0 = 0;
    int f2py_x_d1 = 0;
    int f2py_data_matrix_in_d0 = 0;
    int f2py_data_matrix_in_d1 = 0;
    int f2py_data_matrix_mean_d0 = 0;
    int f2py_mask_d0 = 0;
    int f2py_mask_d1 = 0;
    int f2py_cov_d0 = 0;
    int f2py_cov_d1 = 0;
    int f2py_root_d0 = 0;
    int f2py_root_d1 = 0;
    static char *capi_kwlist[] = {"x","data_matrix_in","data_matrix_mean","prev_root","parent_idx","nbases","mask","cov","root",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOO|:backend.backend.update_init",\
        capi_kwlist,&x_capi,&data_matrix_in_capi,&data_matrix_mean_capi,&prev_root_capi,&parent_idx_capi,&nbases_capi,&mask_capi,&cov_capi,&root_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable x */
    ;
    capi_x_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_init: failed to create array from the 1st argument `x`";
    capi_x_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,x_Dims,x_Rank,  capi_x_intent,x_capi,capi_errmess);
    if (capi_x_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        x = (double *)(PyArray_DATA(capi_x_as_array));

    /* Processing variable data_matrix_in */
    ;
    capi_data_matrix_in_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_init: failed to create array from the 2nd argument `data_matrix_in`";
    capi_data_matrix_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_in_Dims,data_matrix_in_Rank,  capi_data_matrix_in_intent,data_matrix_in_capi,capi_errmess);
    if (capi_data_matrix_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_in = (double *)(PyArray_DATA(capi_data_matrix_in_as_array));

    /* Processing variable data_matrix_mean */
    ;
    capi_data_matrix_mean_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_init: failed to create array from the 3rd argument `data_matrix_mean`";
    capi_data_matrix_mean_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_mean_Dims,data_matrix_mean_Rank,  capi_data_matrix_mean_intent,data_matrix_mean_capi,capi_errmess);
    if (capi_data_matrix_mean_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_mean = (double *)(PyArray_DATA(capi_data_matrix_mean_as_array));

    /* Processing variable prev_root */
        f2py_success = double_from_pyobj(&prev_root,prev_root_capi,"backend.backend.update_init() 4th argument (prev_root) can't be converted to double");
    if (f2py_success) {
    /* Processing variable parent_idx */
        f2py_success = int_from_pyobj(&parent_idx,parent_idx_capi,"backend.backend.update_init() 5th argument (parent_idx) can't be converted to int");
    if (f2py_success) {
    /* Processing variable nbases */
        f2py_success = int_from_pyobj(&nbases,nbases_capi,"backend.backend.update_init() 6th argument (nbases) can't be converted to int");
    if (f2py_success) {
    /* Processing variable mask */
    ;
    capi_mask_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_init: failed to create array from the 7th argument `mask`";
    capi_mask_as_array = ndarray_from_pyobj(  NPY_INT,1,mask_Dims,mask_Rank,  capi_mask_intent,mask_capi,capi_errmess);
    if (capi_mask_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mask = (int *)(PyArray_DATA(capi_mask_as_array));

    /* Processing variable cov */
    ;
    capi_cov_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_init: failed to create array from the 8th argument `cov`";
    capi_cov_as_array = ndarray_from_pyobj(  NPY_INT,1,cov_Dims,cov_Rank,  capi_cov_intent,cov_capi,capi_errmess);
    if (capi_cov_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        cov = (int *)(PyArray_DATA(capi_cov_as_array));

    /* Processing variable root */
    ;
    capi_root_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_init: failed to create array from the 9th argument `root`";
    capi_root_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,root_Dims,root_Rank,  capi_root_intent,root_capi,capi_errmess);
    if (capi_root_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        root = (double *)(PyArray_DATA(capi_root_as_array));

    /* Processing variable update_mean */
    /* Processing variable update */
    update_Dims[0]=size(data_matrix_in, 1);
    capi_update_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.update_init: failed to create array from the hidden `update`";
    capi_update_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,update_Dims,update_Rank,  capi_update_intent,Py_None,capi_errmess);
    if (capi_update_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        update = (double *)(PyArray_DATA(capi_update_as_array));

    /* Processing variable f2py_x_d0 */
    f2py_x_d0 = shape(x, 0);
    /* Processing variable f2py_x_d1 */
    f2py_x_d1 = shape(x, 1);
    /* Processing variable f2py_data_matrix_in_d0 */
    f2py_data_matrix_in_d0 = shape(data_matrix_in, 0);
    /* Processing variable f2py_data_matrix_in_d1 */
    f2py_data_matrix_in_d1 = shape(data_matrix_in, 1);
    /* Processing variable f2py_data_matrix_mean_d0 */
    f2py_data_matrix_mean_d0 = shape(data_matrix_mean, 0);
    /* Processing variable f2py_mask_d0 */
    f2py_mask_d0 = shape(mask, 0);
    /* Processing variable f2py_mask_d1 */
    f2py_mask_d1 = shape(mask, 1);
    /* Processing variable f2py_cov_d0 */
    f2py_cov_d0 = shape(cov, 0);
    /* Processing variable f2py_cov_d1 */
    f2py_cov_d1 = shape(cov, 1);
    /* Processing variable f2py_root_d0 */
    f2py_root_d0 = shape(root, 0);
    /* Processing variable f2py_root_d1 */
    f2py_root_d1 = shape(root, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(x,data_matrix_in,data_matrix_mean,&prev_root,&parent_idx,&nbases,mask,cov,root,update,&update_mean,&f2py_x_d0,&f2py_x_d1,&f2py_data_matrix_in_d0,&f2py_data_matrix_in_d1,&f2py_data_matrix_mean_d0,&f2py_mask_d0,&f2py_mask_d1,&f2py_cov_d0,&f2py_cov_d1,&f2py_root_d0,&f2py_root_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("Nd",capi_update_as_array,update_mean);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_root_d1 */
    /* End of cleaning variable f2py_root_d0 */
    /* End of cleaning variable f2py_cov_d1 */
    /* End of cleaning variable f2py_cov_d0 */
    /* End of cleaning variable f2py_mask_d1 */
    /* End of cleaning variable f2py_mask_d0 */
    /* End of cleaning variable f2py_data_matrix_mean_d0 */
    /* End of cleaning variable f2py_data_matrix_in_d1 */
    /* End of cleaning variable f2py_data_matrix_in_d0 */
    /* End of cleaning variable f2py_x_d1 */
    /* End of cleaning variable f2py_x_d0 */
    }  /* if (capi_update_as_array == NULL) ... else of update */
    /* End of cleaning variable update */
    /* End of cleaning variable update_mean */
    if((PyObject *)capi_root_as_array!=root_capi) {
        Py_XDECREF(capi_root_as_array); }
    }  /* if (capi_root_as_array == NULL) ... else of root */
    /* End of cleaning variable root */
    if((PyObject *)capi_cov_as_array!=cov_capi) {
        Py_XDECREF(capi_cov_as_array); }
    }  /* if (capi_cov_as_array == NULL) ... else of cov */
    /* End of cleaning variable cov */
    if((PyObject *)capi_mask_as_array!=mask_capi) {
        Py_XDECREF(capi_mask_as_array); }
    }  /* if (capi_mask_as_array == NULL) ... else of mask */
    /* End of cleaning variable mask */
    } /*if (f2py_success) of nbases*/
    /* End of cleaning variable nbases */
    } /*if (f2py_success) of parent_idx*/
    /* End of cleaning variable parent_idx */
    } /*if (f2py_success) of prev_root*/
    /* End of cleaning variable prev_root */
    if((PyObject *)capi_data_matrix_mean_as_array!=data_matrix_mean_capi) {
        Py_XDECREF(capi_data_matrix_mean_as_array); }
    }  /* if (capi_data_matrix_mean_as_array == NULL) ... else of data_matrix_mean */
    /* End of cleaning variable data_matrix_mean */
    if((PyObject *)capi_data_matrix_in_as_array!=data_matrix_in_capi) {
        Py_XDECREF(capi_data_matrix_in_as_array); }
    }  /* if (capi_data_matrix_in_as_array == NULL) ... else of data_matrix_in */
    /* End of cleaning variable data_matrix_in */
    if((PyObject *)capi_x_as_array!=x_capi) {
        Py_XDECREF(capi_x_as_array); }
    }  /* if (capi_x_as_array == NULL) ... else of x */
    /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of update_init *****************************/

/***************************** update_data_matrix *****************************/
static char doc_f2py_rout_backend_backend_update_data_matrix[] = "\
update_data_matrix(data_matrix_in,data_matrix_mean,update,update_mean)\n\nWrapper for ``update_data_matrix``.\
\n\nParameters\n----------\n"
"data_matrix_in : in/output rank-2 array('d') with bounds (f2py_data_matrix_in_d0,f2py_data_matrix_in_d1)\n"
"data_matrix_mean : in/output rank-1 array('d') with bounds (f2py_data_matrix_mean_d0)\n"
"update : input rank-1 array('d') with bounds (f2py_update_d0)\n"
"update_mean : input float";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_update_data_matrix(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *data_matrix_in = NULL;
    npy_intp data_matrix_in_Dims[2] = {-1, -1};
    const int data_matrix_in_Rank = 2;
    PyArrayObject *capi_data_matrix_in_as_array = NULL;
    int capi_data_matrix_in_intent = 0;
    PyObject *data_matrix_in_capi = Py_None;
    double *data_matrix_mean = NULL;
    npy_intp data_matrix_mean_Dims[1] = {-1};
    const int data_matrix_mean_Rank = 1;
    PyArrayObject *capi_data_matrix_mean_as_array = NULL;
    int capi_data_matrix_mean_intent = 0;
    PyObject *data_matrix_mean_capi = Py_None;
    double *update = NULL;
    npy_intp update_Dims[1] = {-1};
    const int update_Rank = 1;
    PyArrayObject *capi_update_as_array = NULL;
    int capi_update_intent = 0;
    PyObject *update_capi = Py_None;
    double update_mean = 0;
    PyObject *update_mean_capi = Py_None;
    int f2py_data_matrix_in_d0 = 0;
    int f2py_data_matrix_in_d1 = 0;
    int f2py_data_matrix_mean_d0 = 0;
    int f2py_update_d0 = 0;
    static char *capi_kwlist[] = {"data_matrix_in","data_matrix_mean","update","update_mean",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOO|:backend.backend.update_data_matrix",\
        capi_kwlist,&data_matrix_in_capi,&data_matrix_mean_capi,&update_capi,&update_mean_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable data_matrix_in */
    ;
    capi_data_matrix_in_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_data_matrix: failed to create array from the 1st argument `data_matrix_in`";
    capi_data_matrix_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_in_Dims,data_matrix_in_Rank,  capi_data_matrix_in_intent,data_matrix_in_capi,capi_errmess);
    if (capi_data_matrix_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_in = (double *)(PyArray_DATA(capi_data_matrix_in_as_array));

    /* Processing variable data_matrix_mean */
    ;
    capi_data_matrix_mean_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_data_matrix: failed to create array from the 2nd argument `data_matrix_mean`";
    capi_data_matrix_mean_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_mean_Dims,data_matrix_mean_Rank,  capi_data_matrix_mean_intent,data_matrix_mean_capi,capi_errmess);
    if (capi_data_matrix_mean_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_mean = (double *)(PyArray_DATA(capi_data_matrix_mean_as_array));

    /* Processing variable update */
    ;
    capi_update_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_data_matrix: failed to create array from the 3rd argument `update`";
    capi_update_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,update_Dims,update_Rank,  capi_update_intent,update_capi,capi_errmess);
    if (capi_update_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        update = (double *)(PyArray_DATA(capi_update_as_array));

    /* Processing variable update_mean */
        f2py_success = double_from_pyobj(&update_mean,update_mean_capi,"backend.backend.update_data_matrix() 4th argument (update_mean) can't be converted to double");
    if (f2py_success) {
    /* Processing variable f2py_data_matrix_in_d0 */
    f2py_data_matrix_in_d0 = shape(data_matrix_in, 0);
    /* Processing variable f2py_data_matrix_in_d1 */
    f2py_data_matrix_in_d1 = shape(data_matrix_in, 1);
    /* Processing variable f2py_data_matrix_mean_d0 */
    f2py_data_matrix_mean_d0 = shape(data_matrix_mean, 0);
    /* Processing variable f2py_update_d0 */
    f2py_update_d0 = shape(update, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(data_matrix_in,data_matrix_mean,update,&update_mean,&f2py_data_matrix_in_d0,&f2py_data_matrix_in_d1,&f2py_data_matrix_mean_d0,&f2py_update_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_update_d0 */
    /* End of cleaning variable f2py_data_matrix_mean_d0 */
    /* End of cleaning variable f2py_data_matrix_in_d1 */
    /* End of cleaning variable f2py_data_matrix_in_d0 */
    } /*if (f2py_success) of update_mean*/
    /* End of cleaning variable update_mean */
    if((PyObject *)capi_update_as_array!=update_capi) {
        Py_XDECREF(capi_update_as_array); }
    }  /* if (capi_update_as_array == NULL) ... else of update */
    /* End of cleaning variable update */
    if((PyObject *)capi_data_matrix_mean_as_array!=data_matrix_mean_capi) {
        Py_XDECREF(capi_data_matrix_mean_as_array); }
    }  /* if (capi_data_matrix_mean_as_array == NULL) ... else of data_matrix_mean */
    /* End of cleaning variable data_matrix_mean */
    if((PyObject *)capi_data_matrix_in_as_array!=data_matrix_in_capi) {
        Py_XDECREF(capi_data_matrix_in_as_array); }
    }  /* if (capi_data_matrix_in_as_array == NULL) ... else of data_matrix_in */
    /* End of cleaning variable data_matrix_in */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************* end of update_data_matrix *************************/

/************************** update_covariance_matrix **************************/
static char doc_f2py_rout_backend_backend_update_covariance_matrix[] = "\
covariance_addition = update_covariance_matrix(covariance_matrix_in,data_matrix_in,update)\n\nWrapper for ``update_covariance_matrix``.\
\n\nParameters\n----------\n"
"covariance_matrix_in : in/output rank-2 array('d') with bounds (f2py_covariance_matrix_in_d0,f2py_covariance_matrix_in_d1)\n"
"data_matrix_in : input rank-2 array('d') with bounds (f2py_data_matrix_in_d0,f2py_data_matrix_in_d1)\n"
"update : input rank-1 array('d') with bounds (f2py_update_d0)\n"
"\nReturns\n-------\n"
"covariance_addition : rank-1 array('d') with bounds (size(covariance_matrix_in, 2))";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_update_covariance_matrix(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *covariance_matrix_in = NULL;
    npy_intp covariance_matrix_in_Dims[2] = {-1, -1};
    const int covariance_matrix_in_Rank = 2;
    PyArrayObject *capi_covariance_matrix_in_as_array = NULL;
    int capi_covariance_matrix_in_intent = 0;
    PyObject *covariance_matrix_in_capi = Py_None;
    double *data_matrix_in = NULL;
    npy_intp data_matrix_in_Dims[2] = {-1, -1};
    const int data_matrix_in_Rank = 2;
    PyArrayObject *capi_data_matrix_in_as_array = NULL;
    int capi_data_matrix_in_intent = 0;
    PyObject *data_matrix_in_capi = Py_None;
    double *update = NULL;
    npy_intp update_Dims[1] = {-1};
    const int update_Rank = 1;
    PyArrayObject *capi_update_as_array = NULL;
    int capi_update_intent = 0;
    PyObject *update_capi = Py_None;
    double *covariance_addition = NULL;
    npy_intp covariance_addition_Dims[1] = {-1};
    const int covariance_addition_Rank = 1;
    PyArrayObject *capi_covariance_addition_as_array = NULL;
    int capi_covariance_addition_intent = 0;
    int f2py_covariance_matrix_in_d0 = 0;
    int f2py_covariance_matrix_in_d1 = 0;
    int f2py_data_matrix_in_d0 = 0;
    int f2py_data_matrix_in_d1 = 0;
    int f2py_update_d0 = 0;
    static char *capi_kwlist[] = {"covariance_matrix_in","data_matrix_in","update",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|:backend.backend.update_covariance_matrix",\
        capi_kwlist,&covariance_matrix_in_capi,&data_matrix_in_capi,&update_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable covariance_matrix_in */
    ;
    capi_covariance_matrix_in_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_covariance_matrix: failed to create array from the 1st argument `covariance_matrix_in`";
    capi_covariance_matrix_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,covariance_matrix_in_Dims,covariance_matrix_in_Rank,  capi_covariance_matrix_in_intent,covariance_matrix_in_capi,capi_errmess);
    if (capi_covariance_matrix_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        covariance_matrix_in = (double *)(PyArray_DATA(capi_covariance_matrix_in_as_array));

    /* Processing variable data_matrix_in */
    ;
    capi_data_matrix_in_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_covariance_matrix: failed to create array from the 2nd argument `data_matrix_in`";
    capi_data_matrix_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_in_Dims,data_matrix_in_Rank,  capi_data_matrix_in_intent,data_matrix_in_capi,capi_errmess);
    if (capi_data_matrix_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_in = (double *)(PyArray_DATA(capi_data_matrix_in_as_array));

    /* Processing variable update */
    ;
    capi_update_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_covariance_matrix: failed to create array from the 3rd argument `update`";
    capi_update_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,update_Dims,update_Rank,  capi_update_intent,update_capi,capi_errmess);
    if (capi_update_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        update = (double *)(PyArray_DATA(capi_update_as_array));

    /* Processing variable covariance_addition */
    covariance_addition_Dims[0]=size(covariance_matrix_in, 2);
    capi_covariance_addition_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.update_covariance_matrix: failed to create array from the hidden `covariance_addition`";
    capi_covariance_addition_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,covariance_addition_Dims,covariance_addition_Rank,  capi_covariance_addition_intent,Py_None,capi_errmess);
    if (capi_covariance_addition_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        covariance_addition = (double *)(PyArray_DATA(capi_covariance_addition_as_array));

    /* Processing variable f2py_covariance_matrix_in_d0 */
    f2py_covariance_matrix_in_d0 = shape(covariance_matrix_in, 0);
    /* Processing variable f2py_covariance_matrix_in_d1 */
    f2py_covariance_matrix_in_d1 = shape(covariance_matrix_in, 1);
    /* Processing variable f2py_data_matrix_in_d0 */
    f2py_data_matrix_in_d0 = shape(data_matrix_in, 0);
    /* Processing variable f2py_data_matrix_in_d1 */
    f2py_data_matrix_in_d1 = shape(data_matrix_in, 1);
    /* Processing variable f2py_update_d0 */
    f2py_update_d0 = shape(update, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(covariance_matrix_in,data_matrix_in,update,covariance_addition,&f2py_covariance_matrix_in_d0,&f2py_covariance_matrix_in_d1,&f2py_data_matrix_in_d0,&f2py_data_matrix_in_d1,&f2py_update_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_covariance_addition_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_update_d0 */
    /* End of cleaning variable f2py_data_matrix_in_d1 */
    /* End of cleaning variable f2py_data_matrix_in_d0 */
    /* End of cleaning variable f2py_covariance_matrix_in_d1 */
    /* End of cleaning variable f2py_covariance_matrix_in_d0 */
    }  /* if (capi_covariance_addition_as_array == NULL) ... else of covariance_addition */
    /* End of cleaning variable covariance_addition */
    if((PyObject *)capi_update_as_array!=update_capi) {
        Py_XDECREF(capi_update_as_array); }
    }  /* if (capi_update_as_array == NULL) ... else of update */
    /* End of cleaning variable update */
    if((PyObject *)capi_data_matrix_in_as_array!=data_matrix_in_capi) {
        Py_XDECREF(capi_data_matrix_in_as_array); }
    }  /* if (capi_data_matrix_in_as_array == NULL) ... else of data_matrix_in */
    /* End of cleaning variable data_matrix_in */
    if((PyObject *)capi_covariance_matrix_in_as_array!=covariance_matrix_in_capi) {
        Py_XDECREF(capi_covariance_matrix_in_as_array); }
    }  /* if (capi_covariance_matrix_in_as_array == NULL) ... else of covariance_matrix_in */
    /* End of cleaning variable covariance_matrix_in */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************** end of update_covariance_matrix **********************/

/********************************* update_rhs *********************************/
static char doc_f2py_rout_backend_backend_update_rhs[] = "\
update_rhs(rhs_in,update,y,y_mean)\n\nWrapper for ``update_rhs``.\
\n\nParameters\n----------\n"
"rhs_in : in/output rank-1 array('d') with bounds (f2py_rhs_in_d0)\n"
"update : input rank-1 array('d') with bounds (f2py_update_d0)\n"
"y : input rank-1 array('d') with bounds (f2py_y_d0)\n"
"y_mean : input float";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_update_rhs(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *rhs_in = NULL;
    npy_intp rhs_in_Dims[1] = {-1};
    const int rhs_in_Rank = 1;
    PyArrayObject *capi_rhs_in_as_array = NULL;
    int capi_rhs_in_intent = 0;
    PyObject *rhs_in_capi = Py_None;
    double *update = NULL;
    npy_intp update_Dims[1] = {-1};
    const int update_Rank = 1;
    PyArrayObject *capi_update_as_array = NULL;
    int capi_update_intent = 0;
    PyObject *update_capi = Py_None;
    double *y = NULL;
    npy_intp y_Dims[1] = {-1};
    const int y_Rank = 1;
    PyArrayObject *capi_y_as_array = NULL;
    int capi_y_intent = 0;
    PyObject *y_capi = Py_None;
    double y_mean = 0;
    PyObject *y_mean_capi = Py_None;
    int f2py_rhs_in_d0 = 0;
    int f2py_update_d0 = 0;
    int f2py_y_d0 = 0;
    static char *capi_kwlist[] = {"rhs_in","update","y","y_mean",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOO|:backend.backend.update_rhs",\
        capi_kwlist,&rhs_in_capi,&update_capi,&y_capi,&y_mean_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable rhs_in */
    ;
    capi_rhs_in_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_rhs: failed to create array from the 1st argument `rhs_in`";
    capi_rhs_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rhs_in_Dims,rhs_in_Rank,  capi_rhs_in_intent,rhs_in_capi,capi_errmess);
    if (capi_rhs_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rhs_in = (double *)(PyArray_DATA(capi_rhs_in_as_array));

    /* Processing variable update */
    ;
    capi_update_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_rhs: failed to create array from the 2nd argument `update`";
    capi_update_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,update_Dims,update_Rank,  capi_update_intent,update_capi,capi_errmess);
    if (capi_update_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        update = (double *)(PyArray_DATA(capi_update_as_array));

    /* Processing variable y */
    ;
    capi_y_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_rhs: failed to create array from the 3rd argument `y`";
    capi_y_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,y_Dims,y_Rank,  capi_y_intent,y_capi,capi_errmess);
    if (capi_y_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        y = (double *)(PyArray_DATA(capi_y_as_array));

    /* Processing variable y_mean */
        f2py_success = double_from_pyobj(&y_mean,y_mean_capi,"backend.backend.update_rhs() 4th argument (y_mean) can't be converted to double");
    if (f2py_success) {
    /* Processing variable f2py_rhs_in_d0 */
    f2py_rhs_in_d0 = shape(rhs_in, 0);
    /* Processing variable f2py_update_d0 */
    f2py_update_d0 = shape(update, 0);
    /* Processing variable f2py_y_d0 */
    f2py_y_d0 = shape(y, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(rhs_in,update,y,&y_mean,&f2py_rhs_in_d0,&f2py_update_d0,&f2py_y_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_y_d0 */
    /* End of cleaning variable f2py_update_d0 */
    /* End of cleaning variable f2py_rhs_in_d0 */
    } /*if (f2py_success) of y_mean*/
    /* End of cleaning variable y_mean */
    if((PyObject *)capi_y_as_array!=y_capi) {
        Py_XDECREF(capi_y_as_array); }
    }  /* if (capi_y_as_array == NULL) ... else of y */
    /* End of cleaning variable y */
    if((PyObject *)capi_update_as_array!=update_capi) {
        Py_XDECREF(capi_update_as_array); }
    }  /* if (capi_update_as_array == NULL) ... else of update */
    /* End of cleaning variable update */
    if((PyObject *)capi_rhs_in_as_array!=rhs_in_capi) {
        Py_XDECREF(capi_rhs_in_as_array); }
    }  /* if (capi_rhs_in_as_array == NULL) ... else of rhs_in */
    /* End of cleaning variable rhs_in */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of update_rhs *****************************/

/***************************** decompose_addition *****************************/
static char doc_f2py_rout_backend_backend_decompose_addition[] = "\
eigenvalues,eigenvectors = decompose_addition(covariance_addition)\n\nWrapper for ``decompose_addition``.\
\n\nParameters\n----------\n"
"covariance_addition : input rank-1 array('d') with bounds (f2py_covariance_addition_d0)\n"
"\nReturns\n-------\n"
"eigenvalues : rank-1 array('d') with bounds (2)\n"
"eigenvectors : rank-2 array('d') with bounds (2,size(covariance_addition))";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_decompose_addition(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *covariance_addition = NULL;
    npy_intp covariance_addition_Dims[1] = {-1};
    const int covariance_addition_Rank = 1;
    PyArrayObject *capi_covariance_addition_as_array = NULL;
    int capi_covariance_addition_intent = 0;
    PyObject *covariance_addition_capi = Py_None;
    double *eigenvalues = NULL;
    npy_intp eigenvalues_Dims[1] = {-1};
    const int eigenvalues_Rank = 1;
    PyArrayObject *capi_eigenvalues_as_array = NULL;
    int capi_eigenvalues_intent = 0;
    double *eigenvectors = NULL;
    npy_intp eigenvectors_Dims[2] = {-1, -1};
    const int eigenvectors_Rank = 2;
    PyArrayObject *capi_eigenvectors_as_array = NULL;
    int capi_eigenvectors_intent = 0;
    int f2py_covariance_addition_d0 = 0;
    static char *capi_kwlist[] = {"covariance_addition",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "O|:backend.backend.decompose_addition",\
        capi_kwlist,&covariance_addition_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable covariance_addition */
    ;
    capi_covariance_addition_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.decompose_addition: failed to create array from the 1st argument `covariance_addition`";
    capi_covariance_addition_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,covariance_addition_Dims,covariance_addition_Rank,  capi_covariance_addition_intent,covariance_addition_capi,capi_errmess);
    if (capi_covariance_addition_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        covariance_addition = (double *)(PyArray_DATA(capi_covariance_addition_as_array));

    /* Processing variable eigenvalues */
    eigenvalues_Dims[0]=2;
    capi_eigenvalues_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.decompose_addition: failed to create array from the hidden `eigenvalues`";
    capi_eigenvalues_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,eigenvalues_Dims,eigenvalues_Rank,  capi_eigenvalues_intent,Py_None,capi_errmess);
    if (capi_eigenvalues_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        eigenvalues = (double *)(PyArray_DATA(capi_eigenvalues_as_array));

    /* Processing variable eigenvectors */
    eigenvectors_Dims[0]=2,eigenvectors_Dims[1]=size(covariance_addition);
    capi_eigenvectors_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.decompose_addition: failed to create array from the hidden `eigenvectors`";
    capi_eigenvectors_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,eigenvectors_Dims,eigenvectors_Rank,  capi_eigenvectors_intent,Py_None,capi_errmess);
    if (capi_eigenvectors_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        eigenvectors = (double *)(PyArray_DATA(capi_eigenvectors_as_array));

    /* Processing variable f2py_covariance_addition_d0 */
    f2py_covariance_addition_d0 = shape(covariance_addition, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(covariance_addition,eigenvalues,eigenvectors,&f2py_covariance_addition_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NN",capi_eigenvalues_as_array,capi_eigenvectors_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_covariance_addition_d0 */
    }  /* if (capi_eigenvectors_as_array == NULL) ... else of eigenvectors */
    /* End of cleaning variable eigenvectors */
    }  /* if (capi_eigenvalues_as_array == NULL) ... else of eigenvalues */
    /* End of cleaning variable eigenvalues */
    if((PyObject *)capi_covariance_addition_as_array!=covariance_addition_capi) {
        Py_XDECREF(capi_covariance_addition_as_array); }
    }  /* if (capi_covariance_addition_as_array == NULL) ... else of covariance_addition */
    /* End of cleaning variable covariance_addition */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************* end of decompose_addition *************************/

/****************************** update_cholesky ******************************/
static char doc_f2py_rout_backend_backend_update_cholesky[] = "\
update_cholesky(chol,update_vector,multiplier)\n\nWrapper for ``update_cholesky``.\
\n\nParameters\n----------\n"
"chol : in/output rank-2 array('d') with bounds (f2py_chol_d0,f2py_chol_d1)\n"
"update_vector : input rank-1 array('d') with bounds (f2py_update_vector_d0)\n"
"multiplier : input float";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_update_cholesky(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *chol = NULL;
    npy_intp chol_Dims[2] = {-1, -1};
    const int chol_Rank = 2;
    PyArrayObject *capi_chol_as_array = NULL;
    int capi_chol_intent = 0;
    PyObject *chol_capi = Py_None;
    double *update_vector = NULL;
    npy_intp update_vector_Dims[1] = {-1};
    const int update_vector_Rank = 1;
    PyArrayObject *capi_update_vector_as_array = NULL;
    int capi_update_vector_intent = 0;
    PyObject *update_vector_capi = Py_None;
    double multiplier = 0;
    PyObject *multiplier_capi = Py_None;
    int f2py_chol_d0 = 0;
    int f2py_chol_d1 = 0;
    int f2py_update_vector_d0 = 0;
    static char *capi_kwlist[] = {"chol","update_vector","multiplier",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|:backend.backend.update_cholesky",\
        capi_kwlist,&chol_capi,&update_vector_capi,&multiplier_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable chol */
    ;
    capi_chol_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_cholesky: failed to create array from the 1st argument `chol`";
    capi_chol_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,chol_Dims,chol_Rank,  capi_chol_intent,chol_capi,capi_errmess);
    if (capi_chol_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        chol = (double *)(PyArray_DATA(capi_chol_as_array));

    /* Processing variable update_vector */
    ;
    capi_update_vector_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_cholesky: failed to create array from the 2nd argument `update_vector`";
    capi_update_vector_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,update_vector_Dims,update_vector_Rank,  capi_update_vector_intent,update_vector_capi,capi_errmess);
    if (capi_update_vector_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        update_vector = (double *)(PyArray_DATA(capi_update_vector_as_array));

    /* Processing variable multiplier */
        f2py_success = double_from_pyobj(&multiplier,multiplier_capi,"backend.backend.update_cholesky() 3rd argument (multiplier) can't be converted to double");
    if (f2py_success) {
    /* Processing variable f2py_chol_d0 */
    f2py_chol_d0 = shape(chol, 0);
    /* Processing variable f2py_chol_d1 */
    f2py_chol_d1 = shape(chol, 1);
    /* Processing variable f2py_update_vector_d0 */
    f2py_update_vector_d0 = shape(update_vector, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(chol,update_vector,&multiplier,&f2py_chol_d0,&f2py_chol_d1,&f2py_update_vector_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_update_vector_d0 */
    /* End of cleaning variable f2py_chol_d1 */
    /* End of cleaning variable f2py_chol_d0 */
    } /*if (f2py_success) of multiplier*/
    /* End of cleaning variable multiplier */
    if((PyObject *)capi_update_vector_as_array!=update_vector_capi) {
        Py_XDECREF(capi_update_vector_as_array); }
    }  /* if (capi_update_vector_as_array == NULL) ... else of update_vector */
    /* End of cleaning variable update_vector */
    if((PyObject *)capi_chol_as_array!=chol_capi) {
        Py_XDECREF(capi_chol_as_array); }
    }  /* if (capi_chol_as_array == NULL) ... else of chol */
    /* End of cleaning variable chol */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/*************************** end of update_cholesky ***************************/

/**************************** update_coefficients ****************************/
static char doc_f2py_rout_backend_backend_update_coefficients[] = "\
update_coefficients(coefficients_in,chol,covariance_addition,rhs_in)\n\nWrapper for ``update_coefficients``.\
\n\nParameters\n----------\n"
"coefficients_in : in/output rank-1 array('d') with bounds (f2py_coefficients_in_d0)\n"
"chol : in/output rank-2 array('d') with bounds (f2py_chol_d0,f2py_chol_d1)\n"
"covariance_addition : input rank-1 array('d') with bounds (f2py_covariance_addition_d0)\n"
"rhs_in : input rank-1 array('d') with bounds (f2py_rhs_in_d0)";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_update_coefficients(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *coefficients_in = NULL;
    npy_intp coefficients_in_Dims[1] = {-1};
    const int coefficients_in_Rank = 1;
    PyArrayObject *capi_coefficients_in_as_array = NULL;
    int capi_coefficients_in_intent = 0;
    PyObject *coefficients_in_capi = Py_None;
    double *chol = NULL;
    npy_intp chol_Dims[2] = {-1, -1};
    const int chol_Rank = 2;
    PyArrayObject *capi_chol_as_array = NULL;
    int capi_chol_intent = 0;
    PyObject *chol_capi = Py_None;
    double *covariance_addition = NULL;
    npy_intp covariance_addition_Dims[1] = {-1};
    const int covariance_addition_Rank = 1;
    PyArrayObject *capi_covariance_addition_as_array = NULL;
    int capi_covariance_addition_intent = 0;
    PyObject *covariance_addition_capi = Py_None;
    double *rhs_in = NULL;
    npy_intp rhs_in_Dims[1] = {-1};
    const int rhs_in_Rank = 1;
    PyArrayObject *capi_rhs_in_as_array = NULL;
    int capi_rhs_in_intent = 0;
    PyObject *rhs_in_capi = Py_None;
    int f2py_coefficients_in_d0 = 0;
    int f2py_chol_d0 = 0;
    int f2py_chol_d1 = 0;
    int f2py_covariance_addition_d0 = 0;
    int f2py_rhs_in_d0 = 0;
    static char *capi_kwlist[] = {"coefficients_in","chol","covariance_addition","rhs_in",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOO|:backend.backend.update_coefficients",\
        capi_kwlist,&coefficients_in_capi,&chol_capi,&covariance_addition_capi,&rhs_in_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable coefficients_in */
    ;
    capi_coefficients_in_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_coefficients: failed to create array from the 1st argument `coefficients_in`";
    capi_coefficients_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,coefficients_in_Dims,coefficients_in_Rank,  capi_coefficients_in_intent,coefficients_in_capi,capi_errmess);
    if (capi_coefficients_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        coefficients_in = (double *)(PyArray_DATA(capi_coefficients_in_as_array));

    /* Processing variable chol */
    ;
    capi_chol_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_coefficients: failed to create array from the 2nd argument `chol`";
    capi_chol_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,chol_Dims,chol_Rank,  capi_chol_intent,chol_capi,capi_errmess);
    if (capi_chol_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        chol = (double *)(PyArray_DATA(capi_chol_as_array));

    /* Processing variable covariance_addition */
    ;
    capi_covariance_addition_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_coefficients: failed to create array from the 3rd argument `covariance_addition`";
    capi_covariance_addition_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,covariance_addition_Dims,covariance_addition_Rank,  capi_covariance_addition_intent,covariance_addition_capi,capi_errmess);
    if (capi_covariance_addition_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        covariance_addition = (double *)(PyArray_DATA(capi_covariance_addition_as_array));

    /* Processing variable rhs_in */
    ;
    capi_rhs_in_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_coefficients: failed to create array from the 4th argument `rhs_in`";
    capi_rhs_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rhs_in_Dims,rhs_in_Rank,  capi_rhs_in_intent,rhs_in_capi,capi_errmess);
    if (capi_rhs_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rhs_in = (double *)(PyArray_DATA(capi_rhs_in_as_array));

    /* Processing variable f2py_coefficients_in_d0 */
    f2py_coefficients_in_d0 = shape(coefficients_in, 0);
    /* Processing variable f2py_chol_d0 */
    f2py_chol_d0 = shape(chol, 0);
    /* Processing variable f2py_chol_d1 */
    f2py_chol_d1 = shape(chol, 1);
    /* Processing variable f2py_covariance_addition_d0 */
    f2py_covariance_addition_d0 = shape(covariance_addition, 0);
    /* Processing variable f2py_rhs_in_d0 */
    f2py_rhs_in_d0 = shape(rhs_in, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(coefficients_in,chol,covariance_addition,rhs_in,&f2py_coefficients_in_d0,&f2py_chol_d0,&f2py_chol_d1,&f2py_covariance_addition_d0,&f2py_rhs_in_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_rhs_in_d0 */
    /* End of cleaning variable f2py_covariance_addition_d0 */
    /* End of cleaning variable f2py_chol_d1 */
    /* End of cleaning variable f2py_chol_d0 */
    /* End of cleaning variable f2py_coefficients_in_d0 */
    if((PyObject *)capi_rhs_in_as_array!=rhs_in_capi) {
        Py_XDECREF(capi_rhs_in_as_array); }
    }  /* if (capi_rhs_in_as_array == NULL) ... else of rhs_in */
    /* End of cleaning variable rhs_in */
    if((PyObject *)capi_covariance_addition_as_array!=covariance_addition_capi) {
        Py_XDECREF(capi_covariance_addition_as_array); }
    }  /* if (capi_covariance_addition_as_array == NULL) ... else of covariance_addition */
    /* End of cleaning variable covariance_addition */
    if((PyObject *)capi_chol_as_array!=chol_capi) {
        Py_XDECREF(capi_chol_as_array); }
    }  /* if (capi_chol_as_array == NULL) ... else of chol */
    /* End of cleaning variable chol */
    if((PyObject *)capi_coefficients_in_as_array!=coefficients_in_capi) {
        Py_XDECREF(capi_coefficients_in_as_array); }
    }  /* if (capi_coefficients_in_as_array == NULL) ... else of coefficients_in */
    /* End of cleaning variable coefficients_in */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************* end of update_coefficients *************************/

/********************************* update_fit *********************************/
static char doc_f2py_rout_backend_backend_update_fit[] = "\
lof = update_fit(data_matrix_in,data_matrix_mean,covariance_matrix_in,rhs_in,chol,coefficients_in,x,y,prev_root,parent_idx,y_mean,nbases,penalty,mask,cov,root)\n\nWrapper for ``update_fit``.\
\n\nParameters\n----------\n"
"data_matrix_in : in/output rank-2 array('d') with bounds (f2py_data_matrix_in_d0,f2py_data_matrix_in_d1)\n"
"data_matrix_mean : in/output rank-1 array('d') with bounds (f2py_data_matrix_mean_d0)\n"
"covariance_matrix_in : in/output rank-2 array('d') with bounds (f2py_covariance_matrix_in_d0,f2py_covariance_matrix_in_d1)\n"
"rhs_in : in/output rank-1 array('d') with bounds (f2py_rhs_in_d0)\n"
"chol : in/output rank-2 array('d') with bounds (f2py_chol_d0,f2py_chol_d1)\n"
"coefficients_in : in/output rank-1 array('d') with bounds (f2py_coefficients_in_d0)\n"
"x : input rank-2 array('d') with bounds (f2py_x_d0,f2py_x_d1)\n"
"y : input rank-1 array('d') with bounds (f2py_y_d0)\n"
"prev_root : input float\n"
"parent_idx : input int\n"
"y_mean : input float\n"
"nbases : input int\n"
"penalty : input int\n"
"mask : input rank-2 array('i') with bounds (f2py_mask_d0,f2py_mask_d1)\n"
"cov : input rank-2 array('i') with bounds (f2py_cov_d0,f2py_cov_d1)\n"
"root : input rank-2 array('d') with bounds (f2py_root_d0,f2py_root_d1)\n"
"\nReturns\n-------\n"
"lof : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_update_fit(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,double*,int*,int*,int*,int*,double*,double*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *data_matrix_in = NULL;
    npy_intp data_matrix_in_Dims[2] = {-1, -1};
    const int data_matrix_in_Rank = 2;
    PyArrayObject *capi_data_matrix_in_as_array = NULL;
    int capi_data_matrix_in_intent = 0;
    PyObject *data_matrix_in_capi = Py_None;
    double *data_matrix_mean = NULL;
    npy_intp data_matrix_mean_Dims[1] = {-1};
    const int data_matrix_mean_Rank = 1;
    PyArrayObject *capi_data_matrix_mean_as_array = NULL;
    int capi_data_matrix_mean_intent = 0;
    PyObject *data_matrix_mean_capi = Py_None;
    double *covariance_matrix_in = NULL;
    npy_intp covariance_matrix_in_Dims[2] = {-1, -1};
    const int covariance_matrix_in_Rank = 2;
    PyArrayObject *capi_covariance_matrix_in_as_array = NULL;
    int capi_covariance_matrix_in_intent = 0;
    PyObject *covariance_matrix_in_capi = Py_None;
    double *rhs_in = NULL;
    npy_intp rhs_in_Dims[1] = {-1};
    const int rhs_in_Rank = 1;
    PyArrayObject *capi_rhs_in_as_array = NULL;
    int capi_rhs_in_intent = 0;
    PyObject *rhs_in_capi = Py_None;
    double *chol = NULL;
    npy_intp chol_Dims[2] = {-1, -1};
    const int chol_Rank = 2;
    PyArrayObject *capi_chol_as_array = NULL;
    int capi_chol_intent = 0;
    PyObject *chol_capi = Py_None;
    double *coefficients_in = NULL;
    npy_intp coefficients_in_Dims[1] = {-1};
    const int coefficients_in_Rank = 1;
    PyArrayObject *capi_coefficients_in_as_array = NULL;
    int capi_coefficients_in_intent = 0;
    PyObject *coefficients_in_capi = Py_None;
    double *x = NULL;
    npy_intp x_Dims[2] = {-1, -1};
    const int x_Rank = 2;
    PyArrayObject *capi_x_as_array = NULL;
    int capi_x_intent = 0;
    PyObject *x_capi = Py_None;
    double *y = NULL;
    npy_intp y_Dims[1] = {-1};
    const int y_Rank = 1;
    PyArrayObject *capi_y_as_array = NULL;
    int capi_y_intent = 0;
    PyObject *y_capi = Py_None;
    double prev_root = 0;
    PyObject *prev_root_capi = Py_None;
    int parent_idx = 0;
    PyObject *parent_idx_capi = Py_None;
    double y_mean = 0;
    PyObject *y_mean_capi = Py_None;
    int nbases = 0;
    PyObject *nbases_capi = Py_None;
    int penalty = 0;
    PyObject *penalty_capi = Py_None;
    int *mask = NULL;
    npy_intp mask_Dims[2] = {-1, -1};
    const int mask_Rank = 2;
    PyArrayObject *capi_mask_as_array = NULL;
    int capi_mask_intent = 0;
    PyObject *mask_capi = Py_None;
    int *cov = NULL;
    npy_intp cov_Dims[2] = {-1, -1};
    const int cov_Rank = 2;
    PyArrayObject *capi_cov_as_array = NULL;
    int capi_cov_intent = 0;
    PyObject *cov_capi = Py_None;
    double *root = NULL;
    npy_intp root_Dims[2] = {-1, -1};
    const int root_Rank = 2;
    PyArrayObject *capi_root_as_array = NULL;
    int capi_root_intent = 0;
    PyObject *root_capi = Py_None;
    double lof = 0;
    int f2py_data_matrix_in_d0 = 0;
    int f2py_data_matrix_in_d1 = 0;
    int f2py_data_matrix_mean_d0 = 0;
    int f2py_covariance_matrix_in_d0 = 0;
    int f2py_covariance_matrix_in_d1 = 0;
    int f2py_rhs_in_d0 = 0;
    int f2py_chol_d0 = 0;
    int f2py_chol_d1 = 0;
    int f2py_coefficients_in_d0 = 0;
    int f2py_x_d0 = 0;
    int f2py_x_d1 = 0;
    int f2py_y_d0 = 0;
    int f2py_mask_d0 = 0;
    int f2py_mask_d1 = 0;
    int f2py_cov_d0 = 0;
    int f2py_cov_d1 = 0;
    int f2py_root_d0 = 0;
    int f2py_root_d1 = 0;
    static char *capi_kwlist[] = {"data_matrix_in","data_matrix_mean","covariance_matrix_in","rhs_in","chol","coefficients_in","x","y","prev_root","parent_idx","y_mean","nbases","penalty","mask","cov","root",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOOOOOOOO|:backend.backend.update_fit",\
        capi_kwlist,&data_matrix_in_capi,&data_matrix_mean_capi,&covariance_matrix_in_capi,&rhs_in_capi,&chol_capi,&coefficients_in_capi,&x_capi,&y_capi,&prev_root_capi,&parent_idx_capi,&y_mean_capi,&nbases_capi,&penalty_capi,&mask_capi,&cov_capi,&root_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable data_matrix_in */
    ;
    capi_data_matrix_in_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_fit: failed to create array from the 1st argument `data_matrix_in`";
    capi_data_matrix_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_in_Dims,data_matrix_in_Rank,  capi_data_matrix_in_intent,data_matrix_in_capi,capi_errmess);
    if (capi_data_matrix_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_in = (double *)(PyArray_DATA(capi_data_matrix_in_as_array));

    /* Processing variable data_matrix_mean */
    ;
    capi_data_matrix_mean_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_fit: failed to create array from the 2nd argument `data_matrix_mean`";
    capi_data_matrix_mean_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,data_matrix_mean_Dims,data_matrix_mean_Rank,  capi_data_matrix_mean_intent,data_matrix_mean_capi,capi_errmess);
    if (capi_data_matrix_mean_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        data_matrix_mean = (double *)(PyArray_DATA(capi_data_matrix_mean_as_array));

    /* Processing variable covariance_matrix_in */
    ;
    capi_covariance_matrix_in_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_fit: failed to create array from the 3rd argument `covariance_matrix_in`";
    capi_covariance_matrix_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,covariance_matrix_in_Dims,covariance_matrix_in_Rank,  capi_covariance_matrix_in_intent,covariance_matrix_in_capi,capi_errmess);
    if (capi_covariance_matrix_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        covariance_matrix_in = (double *)(PyArray_DATA(capi_covariance_matrix_in_as_array));

    /* Processing variable rhs_in */
    ;
    capi_rhs_in_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_fit: failed to create array from the 4th argument `rhs_in`";
    capi_rhs_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rhs_in_Dims,rhs_in_Rank,  capi_rhs_in_intent,rhs_in_capi,capi_errmess);
    if (capi_rhs_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rhs_in = (double *)(PyArray_DATA(capi_rhs_in_as_array));

    /* Processing variable chol */
    ;
    capi_chol_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_fit: failed to create array from the 5th argument `chol`";
    capi_chol_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,chol_Dims,chol_Rank,  capi_chol_intent,chol_capi,capi_errmess);
    if (capi_chol_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        chol = (double *)(PyArray_DATA(capi_chol_as_array));

    /* Processing variable coefficients_in */
    ;
    capi_coefficients_in_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.update_fit: failed to create array from the 6th argument `coefficients_in`";
    capi_coefficients_in_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,coefficients_in_Dims,coefficients_in_Rank,  capi_coefficients_in_intent,coefficients_in_capi,capi_errmess);
    if (capi_coefficients_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        coefficients_in = (double *)(PyArray_DATA(capi_coefficients_in_as_array));

    /* Processing variable x */
    ;
    capi_x_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_fit: failed to create array from the 7th argument `x`";
    capi_x_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,x_Dims,x_Rank,  capi_x_intent,x_capi,capi_errmess);
    if (capi_x_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        x = (double *)(PyArray_DATA(capi_x_as_array));

    /* Processing variable y */
    ;
    capi_y_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_fit: failed to create array from the 8th argument `y`";
    capi_y_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,y_Dims,y_Rank,  capi_y_intent,y_capi,capi_errmess);
    if (capi_y_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        y = (double *)(PyArray_DATA(capi_y_as_array));

    /* Processing variable prev_root */
        f2py_success = double_from_pyobj(&prev_root,prev_root_capi,"backend.backend.update_fit() 9th argument (prev_root) can't be converted to double");
    if (f2py_success) {
    /* Processing variable parent_idx */
        f2py_success = int_from_pyobj(&parent_idx,parent_idx_capi,"backend.backend.update_fit() 10th argument (parent_idx) can't be converted to int");
    if (f2py_success) {
    /* Processing variable y_mean */
        f2py_success = double_from_pyobj(&y_mean,y_mean_capi,"backend.backend.update_fit() 11st argument (y_mean) can't be converted to double");
    if (f2py_success) {
    /* Processing variable nbases */
        f2py_success = int_from_pyobj(&nbases,nbases_capi,"backend.backend.update_fit() 12nd argument (nbases) can't be converted to int");
    if (f2py_success) {
    /* Processing variable penalty */
        f2py_success = int_from_pyobj(&penalty,penalty_capi,"backend.backend.update_fit() 13rd argument (penalty) can't be converted to int");
    if (f2py_success) {
    /* Processing variable mask */
    ;
    capi_mask_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_fit: failed to create array from the 14th argument `mask`";
    capi_mask_as_array = ndarray_from_pyobj(  NPY_INT,1,mask_Dims,mask_Rank,  capi_mask_intent,mask_capi,capi_errmess);
    if (capi_mask_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mask = (int *)(PyArray_DATA(capi_mask_as_array));

    /* Processing variable cov */
    ;
    capi_cov_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_fit: failed to create array from the 15th argument `cov`";
    capi_cov_as_array = ndarray_from_pyobj(  NPY_INT,1,cov_Dims,cov_Rank,  capi_cov_intent,cov_capi,capi_errmess);
    if (capi_cov_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        cov = (int *)(PyArray_DATA(capi_cov_as_array));

    /* Processing variable root */
    ;
    capi_root_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.update_fit: failed to create array from the 16th argument `root`";
    capi_root_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,root_Dims,root_Rank,  capi_root_intent,root_capi,capi_errmess);
    if (capi_root_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        root = (double *)(PyArray_DATA(capi_root_as_array));

    /* Processing variable lof */
    /* Processing variable f2py_data_matrix_in_d0 */
    f2py_data_matrix_in_d0 = shape(data_matrix_in, 0);
    /* Processing variable f2py_data_matrix_in_d1 */
    f2py_data_matrix_in_d1 = shape(data_matrix_in, 1);
    /* Processing variable f2py_data_matrix_mean_d0 */
    f2py_data_matrix_mean_d0 = shape(data_matrix_mean, 0);
    /* Processing variable f2py_covariance_matrix_in_d0 */
    f2py_covariance_matrix_in_d0 = shape(covariance_matrix_in, 0);
    /* Processing variable f2py_covariance_matrix_in_d1 */
    f2py_covariance_matrix_in_d1 = shape(covariance_matrix_in, 1);
    /* Processing variable f2py_rhs_in_d0 */
    f2py_rhs_in_d0 = shape(rhs_in, 0);
    /* Processing variable f2py_chol_d0 */
    f2py_chol_d0 = shape(chol, 0);
    /* Processing variable f2py_chol_d1 */
    f2py_chol_d1 = shape(chol, 1);
    /* Processing variable f2py_coefficients_in_d0 */
    f2py_coefficients_in_d0 = shape(coefficients_in, 0);
    /* Processing variable f2py_x_d0 */
    f2py_x_d0 = shape(x, 0);
    /* Processing variable f2py_x_d1 */
    f2py_x_d1 = shape(x, 1);
    /* Processing variable f2py_y_d0 */
    f2py_y_d0 = shape(y, 0);
    /* Processing variable f2py_mask_d0 */
    f2py_mask_d0 = shape(mask, 0);
    /* Processing variable f2py_mask_d1 */
    f2py_mask_d1 = shape(mask, 1);
    /* Processing variable f2py_cov_d0 */
    f2py_cov_d0 = shape(cov, 0);
    /* Processing variable f2py_cov_d1 */
    f2py_cov_d1 = shape(cov, 1);
    /* Processing variable f2py_root_d0 */
    f2py_root_d0 = shape(root, 0);
    /* Processing variable f2py_root_d1 */
    f2py_root_d1 = shape(root, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(data_matrix_in,data_matrix_mean,covariance_matrix_in,rhs_in,chol,coefficients_in,x,y,&prev_root,&parent_idx,&y_mean,&nbases,&penalty,mask,cov,root,&lof,&f2py_data_matrix_in_d0,&f2py_data_matrix_in_d1,&f2py_data_matrix_mean_d0,&f2py_covariance_matrix_in_d0,&f2py_covariance_matrix_in_d1,&f2py_rhs_in_d0,&f2py_chol_d0,&f2py_chol_d1,&f2py_coefficients_in_d0,&f2py_x_d0,&f2py_x_d1,&f2py_y_d0,&f2py_mask_d0,&f2py_mask_d1,&f2py_cov_d0,&f2py_cov_d1,&f2py_root_d0,&f2py_root_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("d",lof);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_root_d1 */
    /* End of cleaning variable f2py_root_d0 */
    /* End of cleaning variable f2py_cov_d1 */
    /* End of cleaning variable f2py_cov_d0 */
    /* End of cleaning variable f2py_mask_d1 */
    /* End of cleaning variable f2py_mask_d0 */
    /* End of cleaning variable f2py_y_d0 */
    /* End of cleaning variable f2py_x_d1 */
    /* End of cleaning variable f2py_x_d0 */
    /* End of cleaning variable f2py_coefficients_in_d0 */
    /* End of cleaning variable f2py_chol_d1 */
    /* End of cleaning variable f2py_chol_d0 */
    /* End of cleaning variable f2py_rhs_in_d0 */
    /* End of cleaning variable f2py_covariance_matrix_in_d1 */
    /* End of cleaning variable f2py_covariance_matrix_in_d0 */
    /* End of cleaning variable f2py_data_matrix_mean_d0 */
    /* End of cleaning variable f2py_data_matrix_in_d1 */
    /* End of cleaning variable f2py_data_matrix_in_d0 */
    /* End of cleaning variable lof */
    if((PyObject *)capi_root_as_array!=root_capi) {
        Py_XDECREF(capi_root_as_array); }
    }  /* if (capi_root_as_array == NULL) ... else of root */
    /* End of cleaning variable root */
    if((PyObject *)capi_cov_as_array!=cov_capi) {
        Py_XDECREF(capi_cov_as_array); }
    }  /* if (capi_cov_as_array == NULL) ... else of cov */
    /* End of cleaning variable cov */
    if((PyObject *)capi_mask_as_array!=mask_capi) {
        Py_XDECREF(capi_mask_as_array); }
    }  /* if (capi_mask_as_array == NULL) ... else of mask */
    /* End of cleaning variable mask */
    } /*if (f2py_success) of penalty*/
    /* End of cleaning variable penalty */
    } /*if (f2py_success) of nbases*/
    /* End of cleaning variable nbases */
    } /*if (f2py_success) of y_mean*/
    /* End of cleaning variable y_mean */
    } /*if (f2py_success) of parent_idx*/
    /* End of cleaning variable parent_idx */
    } /*if (f2py_success) of prev_root*/
    /* End of cleaning variable prev_root */
    if((PyObject *)capi_y_as_array!=y_capi) {
        Py_XDECREF(capi_y_as_array); }
    }  /* if (capi_y_as_array == NULL) ... else of y */
    /* End of cleaning variable y */
    if((PyObject *)capi_x_as_array!=x_capi) {
        Py_XDECREF(capi_x_as_array); }
    }  /* if (capi_x_as_array == NULL) ... else of x */
    /* End of cleaning variable x */
    if((PyObject *)capi_coefficients_in_as_array!=coefficients_in_capi) {
        Py_XDECREF(capi_coefficients_in_as_array); }
    }  /* if (capi_coefficients_in_as_array == NULL) ... else of coefficients_in */
    /* End of cleaning variable coefficients_in */
    if((PyObject *)capi_chol_as_array!=chol_capi) {
        Py_XDECREF(capi_chol_as_array); }
    }  /* if (capi_chol_as_array == NULL) ... else of chol */
    /* End of cleaning variable chol */
    if((PyObject *)capi_rhs_in_as_array!=rhs_in_capi) {
        Py_XDECREF(capi_rhs_in_as_array); }
    }  /* if (capi_rhs_in_as_array == NULL) ... else of rhs_in */
    /* End of cleaning variable rhs_in */
    if((PyObject *)capi_covariance_matrix_in_as_array!=covariance_matrix_in_capi) {
        Py_XDECREF(capi_covariance_matrix_in_as_array); }
    }  /* if (capi_covariance_matrix_in_as_array == NULL) ... else of covariance_matrix_in */
    /* End of cleaning variable covariance_matrix_in */
    if((PyObject *)capi_data_matrix_mean_as_array!=data_matrix_mean_capi) {
        Py_XDECREF(capi_data_matrix_mean_as_array); }
    }  /* if (capi_data_matrix_mean_as_array == NULL) ... else of data_matrix_mean */
    /* End of cleaning variable data_matrix_mean */
    if((PyObject *)capi_data_matrix_in_as_array!=data_matrix_in_capi) {
        Py_XDECREF(capi_data_matrix_in_as_array); }
    }  /* if (capi_data_matrix_in_as_array == NULL) ... else of data_matrix_in */
    /* End of cleaning variable data_matrix_in */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of update_fit *****************************/

/********************************** argsort **********************************/
static char doc_f2py_rout_backend_backend_argsort[] = "\
indices = argsort(array)\n\nWrapper for ``argsort``.\
\n\nParameters\n----------\n"
"array : input rank-1 array('d') with bounds (f2py_array_d0)\n"
"\nReturns\n-------\n"
"indices : rank-1 array('i') with bounds (size(array))";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_argsort(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *array = NULL;
    npy_intp array_Dims[1] = {-1};
    const int array_Rank = 1;
    PyArrayObject *capi_array_as_array = NULL;
    int capi_array_intent = 0;
    PyObject *array_capi = Py_None;
    int *indices = NULL;
    npy_intp indices_Dims[1] = {-1};
    const int indices_Rank = 1;
    PyArrayObject *capi_indices_as_array = NULL;
    int capi_indices_intent = 0;
    int f2py_array_d0 = 0;
    static char *capi_kwlist[] = {"array",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "O|:backend.backend.argsort",\
        capi_kwlist,&array_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable array */
    ;
    capi_array_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.argsort: failed to create array from the 1st argument `array`";
    capi_array_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,array_Dims,array_Rank,  capi_array_intent,array_capi,capi_errmess);
    if (capi_array_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        array = (double *)(PyArray_DATA(capi_array_as_array));

    /* Processing variable indices */
    indices_Dims[0]=size(array);
    capi_indices_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.argsort: failed to create array from the hidden `indices`";
    capi_indices_as_array = ndarray_from_pyobj(  NPY_INT,1,indices_Dims,indices_Rank,  capi_indices_intent,Py_None,capi_errmess);
    if (capi_indices_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        indices = (int *)(PyArray_DATA(capi_indices_as_array));

    /* Processing variable f2py_array_d0 */
    f2py_array_d0 = shape(array, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(array,indices,&f2py_array_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_indices_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_array_d0 */
    }  /* if (capi_indices_as_array == NULL) ... else of indices */
    /* End of cleaning variable indices */
    if((PyObject *)capi_array_as_array!=array_capi) {
        Py_XDECREF(capi_array_as_array); }
    }  /* if (capi_array_as_array == NULL) ... else of array */
    /* End of cleaning variable array */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************* end of argsort *******************************/

/********************************* add_bases *********************************/
static char doc_f2py_rout_backend_backend_add_bases[] = "\
add_bases(parent,cov_in,root_in,nbases,mask,truncated,cov,root)\n\nWrapper for ``add_bases``.\
\n\nParameters\n----------\n"
"parent : input int\n"
"cov_in : input int\n"
"root_in : input float\n"
"nbases : input int\n"
"mask : in/output rank-2 array('i') with bounds (f2py_mask_d0,f2py_mask_d1)\n"
"truncated : in/output rank-2 array('i') with bounds (f2py_truncated_d0,f2py_truncated_d1)\n"
"cov : in/output rank-2 array('i') with bounds (f2py_cov_d0,f2py_cov_d1)\n"
"root : in/output rank-2 array('d') with bounds (f2py_root_d0,f2py_root_d1)";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_add_bases(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,double*,int*,int*,int*,int*,double*,int*,int*,int*,int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int parent = 0;
    PyObject *parent_capi = Py_None;
    int cov_in = 0;
    PyObject *cov_in_capi = Py_None;
    double root_in = 0;
    PyObject *root_in_capi = Py_None;
    int nbases = 0;
    PyObject *nbases_capi = Py_None;
    int *mask = NULL;
    npy_intp mask_Dims[2] = {-1, -1};
    const int mask_Rank = 2;
    PyArrayObject *capi_mask_as_array = NULL;
    int capi_mask_intent = 0;
    PyObject *mask_capi = Py_None;
    int *truncated = NULL;
    npy_intp truncated_Dims[2] = {-1, -1};
    const int truncated_Rank = 2;
    PyArrayObject *capi_truncated_as_array = NULL;
    int capi_truncated_intent = 0;
    PyObject *truncated_capi = Py_None;
    int *cov = NULL;
    npy_intp cov_Dims[2] = {-1, -1};
    const int cov_Rank = 2;
    PyArrayObject *capi_cov_as_array = NULL;
    int capi_cov_intent = 0;
    PyObject *cov_capi = Py_None;
    double *root = NULL;
    npy_intp root_Dims[2] = {-1, -1};
    const int root_Rank = 2;
    PyArrayObject *capi_root_as_array = NULL;
    int capi_root_intent = 0;
    PyObject *root_capi = Py_None;
    int f2py_mask_d0 = 0;
    int f2py_mask_d1 = 0;
    int f2py_truncated_d0 = 0;
    int f2py_truncated_d1 = 0;
    int f2py_cov_d0 = 0;
    int f2py_cov_d1 = 0;
    int f2py_root_d0 = 0;
    int f2py_root_d1 = 0;
    static char *capi_kwlist[] = {"parent","cov_in","root_in","nbases","mask","truncated","cov","root",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOO|:backend.backend.add_bases",\
        capi_kwlist,&parent_capi,&cov_in_capi,&root_in_capi,&nbases_capi,&mask_capi,&truncated_capi,&cov_capi,&root_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable parent */
        f2py_success = int_from_pyobj(&parent,parent_capi,"backend.backend.add_bases() 1st argument (parent) can't be converted to int");
    if (f2py_success) {
    /* Processing variable cov_in */
        f2py_success = int_from_pyobj(&cov_in,cov_in_capi,"backend.backend.add_bases() 2nd argument (cov_in) can't be converted to int");
    if (f2py_success) {
    /* Processing variable root_in */
        f2py_success = double_from_pyobj(&root_in,root_in_capi,"backend.backend.add_bases() 3rd argument (root_in) can't be converted to double");
    if (f2py_success) {
    /* Processing variable nbases */
        f2py_success = int_from_pyobj(&nbases,nbases_capi,"backend.backend.add_bases() 4th argument (nbases) can't be converted to int");
    if (f2py_success) {
    /* Processing variable mask */
    ;
    capi_mask_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.add_bases: failed to create array from the 5th argument `mask`";
    capi_mask_as_array = ndarray_from_pyobj(  NPY_INT,1,mask_Dims,mask_Rank,  capi_mask_intent,mask_capi,capi_errmess);
    if (capi_mask_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mask = (int *)(PyArray_DATA(capi_mask_as_array));

    /* Processing variable truncated */
    ;
    capi_truncated_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.add_bases: failed to create array from the 6th argument `truncated`";
    capi_truncated_as_array = ndarray_from_pyobj(  NPY_INT,1,truncated_Dims,truncated_Rank,  capi_truncated_intent,truncated_capi,capi_errmess);
    if (capi_truncated_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        truncated = (int *)(PyArray_DATA(capi_truncated_as_array));

    /* Processing variable cov */
    ;
    capi_cov_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.add_bases: failed to create array from the 7th argument `cov`";
    capi_cov_as_array = ndarray_from_pyobj(  NPY_INT,1,cov_Dims,cov_Rank,  capi_cov_intent,cov_capi,capi_errmess);
    if (capi_cov_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        cov = (int *)(PyArray_DATA(capi_cov_as_array));

    /* Processing variable root */
    ;
    capi_root_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "backend.backend.backend.add_bases: failed to create array from the 8th argument `root`";
    capi_root_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,root_Dims,root_Rank,  capi_root_intent,root_capi,capi_errmess);
    if (capi_root_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        root = (double *)(PyArray_DATA(capi_root_as_array));

    /* Processing variable f2py_mask_d0 */
    f2py_mask_d0 = shape(mask, 0);
    /* Processing variable f2py_mask_d1 */
    f2py_mask_d1 = shape(mask, 1);
    /* Processing variable f2py_truncated_d0 */
    f2py_truncated_d0 = shape(truncated, 0);
    /* Processing variable f2py_truncated_d1 */
    f2py_truncated_d1 = shape(truncated, 1);
    /* Processing variable f2py_cov_d0 */
    f2py_cov_d0 = shape(cov, 0);
    /* Processing variable f2py_cov_d1 */
    f2py_cov_d1 = shape(cov, 1);
    /* Processing variable f2py_root_d0 */
    f2py_root_d0 = shape(root, 0);
    /* Processing variable f2py_root_d1 */
    f2py_root_d1 = shape(root, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(&parent,&cov_in,&root_in,&nbases,mask,truncated,cov,root,&f2py_mask_d0,&f2py_mask_d1,&f2py_truncated_d0,&f2py_truncated_d1,&f2py_cov_d0,&f2py_cov_d1,&f2py_root_d0,&f2py_root_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_root_d1 */
    /* End of cleaning variable f2py_root_d0 */
    /* End of cleaning variable f2py_cov_d1 */
    /* End of cleaning variable f2py_cov_d0 */
    /* End of cleaning variable f2py_truncated_d1 */
    /* End of cleaning variable f2py_truncated_d0 */
    /* End of cleaning variable f2py_mask_d1 */
    /* End of cleaning variable f2py_mask_d0 */
    if((PyObject *)capi_root_as_array!=root_capi) {
        Py_XDECREF(capi_root_as_array); }
    }  /* if (capi_root_as_array == NULL) ... else of root */
    /* End of cleaning variable root */
    if((PyObject *)capi_cov_as_array!=cov_capi) {
        Py_XDECREF(capi_cov_as_array); }
    }  /* if (capi_cov_as_array == NULL) ... else of cov */
    /* End of cleaning variable cov */
    if((PyObject *)capi_truncated_as_array!=truncated_capi) {
        Py_XDECREF(capi_truncated_as_array); }
    }  /* if (capi_truncated_as_array == NULL) ... else of truncated */
    /* End of cleaning variable truncated */
    if((PyObject *)capi_mask_as_array!=mask_capi) {
        Py_XDECREF(capi_mask_as_array); }
    }  /* if (capi_mask_as_array == NULL) ... else of mask */
    /* End of cleaning variable mask */
    } /*if (f2py_success) of nbases*/
    /* End of cleaning variable nbases */
    } /*if (f2py_success) of root_in*/
    /* End of cleaning variable root_in */
    } /*if (f2py_success) of cov_in*/
    /* End of cleaning variable cov_in */
    } /*if (f2py_success) of parent*/
    /* End of cleaning variable parent */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/****************************** end of add_bases ******************************/

/******************************** expand_bases ********************************/
static char doc_f2py_rout_backend_backend_expand_bases[] = "\
lof,nbases,mask,truncated,cov,root,coefficients_out = expand_bases(x,y,y_mean,max_nbases,max_ncandidates,aging_factor,penalty)\n\nWrapper for ``expand_bases``.\
\n\nParameters\n----------\n"
"x : input rank-2 array('d') with bounds (f2py_x_d0,f2py_x_d1)\n"
"y : input rank-1 array('d') with bounds (f2py_y_d0)\n"
"y_mean : input float\n"
"max_nbases : input int\n"
"max_ncandidates : input int\n"
"aging_factor : input float\n"
"penalty : input int\n"
"\nReturns\n-------\n"
"lof : float\n"
"nbases : int\n"
"mask : rank-2 array('i') with bounds (max_nbases,max_nbases)\n"
"truncated : rank-2 array('i') with bounds (max_nbases,max_nbases)\n"
"cov : rank-2 array('i') with bounds (max_nbases,max_nbases)\n"
"root : rank-2 array('d') with bounds (max_nbases,max_nbases)\n"
"coefficients_out : rank-1 array('d') with bounds (-1 + max_nbases)";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_expand_bases(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,int*,double*,int*,double*,int*,int*,int*,int*,double*,double*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *x = NULL;
    npy_intp x_Dims[2] = {-1, -1};
    const int x_Rank = 2;
    PyArrayObject *capi_x_as_array = NULL;
    int capi_x_intent = 0;
    PyObject *x_capi = Py_None;
    double *y = NULL;
    npy_intp y_Dims[1] = {-1};
    const int y_Rank = 1;
    PyArrayObject *capi_y_as_array = NULL;
    int capi_y_intent = 0;
    PyObject *y_capi = Py_None;
    double y_mean = 0;
    PyObject *y_mean_capi = Py_None;
    int max_nbases = 0;
    PyObject *max_nbases_capi = Py_None;
    int max_ncandidates = 0;
    PyObject *max_ncandidates_capi = Py_None;
    double aging_factor = 0;
    PyObject *aging_factor_capi = Py_None;
    int penalty = 0;
    PyObject *penalty_capi = Py_None;
    double lof = 0;
    int nbases = 0;
    int *mask = NULL;
    npy_intp mask_Dims[2] = {-1, -1};
    const int mask_Rank = 2;
    PyArrayObject *capi_mask_as_array = NULL;
    int capi_mask_intent = 0;
    int *truncated = NULL;
    npy_intp truncated_Dims[2] = {-1, -1};
    const int truncated_Rank = 2;
    PyArrayObject *capi_truncated_as_array = NULL;
    int capi_truncated_intent = 0;
    int *cov = NULL;
    npy_intp cov_Dims[2] = {-1, -1};
    const int cov_Rank = 2;
    PyArrayObject *capi_cov_as_array = NULL;
    int capi_cov_intent = 0;
    double *root = NULL;
    npy_intp root_Dims[2] = {-1, -1};
    const int root_Rank = 2;
    PyArrayObject *capi_root_as_array = NULL;
    int capi_root_intent = 0;
    double *coefficients_out = NULL;
    npy_intp coefficients_out_Dims[1] = {-1};
    const int coefficients_out_Rank = 1;
    PyArrayObject *capi_coefficients_out_as_array = NULL;
    int capi_coefficients_out_intent = 0;
    int f2py_x_d0 = 0;
    int f2py_x_d1 = 0;
    int f2py_y_d0 = 0;
    static char *capi_kwlist[] = {"x","y","y_mean","max_nbases","max_ncandidates","aging_factor","penalty",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOO|:backend.backend.expand_bases",\
        capi_kwlist,&x_capi,&y_capi,&y_mean_capi,&max_nbases_capi,&max_ncandidates_capi,&aging_factor_capi,&penalty_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable x */
    ;
    capi_x_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.expand_bases: failed to create array from the 1st argument `x`";
    capi_x_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,x_Dims,x_Rank,  capi_x_intent,x_capi,capi_errmess);
    if (capi_x_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        x = (double *)(PyArray_DATA(capi_x_as_array));

    /* Processing variable y */
    ;
    capi_y_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.expand_bases: failed to create array from the 2nd argument `y`";
    capi_y_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,y_Dims,y_Rank,  capi_y_intent,y_capi,capi_errmess);
    if (capi_y_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        y = (double *)(PyArray_DATA(capi_y_as_array));

    /* Processing variable y_mean */
        f2py_success = double_from_pyobj(&y_mean,y_mean_capi,"backend.backend.expand_bases() 3rd argument (y_mean) can't be converted to double");
    if (f2py_success) {
    /* Processing variable max_nbases */
        f2py_success = int_from_pyobj(&max_nbases,max_nbases_capi,"backend.backend.expand_bases() 4th argument (max_nbases) can't be converted to int");
    if (f2py_success) {
    /* Processing variable max_ncandidates */
        f2py_success = int_from_pyobj(&max_ncandidates,max_ncandidates_capi,"backend.backend.expand_bases() 5th argument (max_ncandidates) can't be converted to int");
    if (f2py_success) {
    /* Processing variable aging_factor */
        f2py_success = double_from_pyobj(&aging_factor,aging_factor_capi,"backend.backend.expand_bases() 6th argument (aging_factor) can't be converted to double");
    if (f2py_success) {
    /* Processing variable penalty */
        f2py_success = int_from_pyobj(&penalty,penalty_capi,"backend.backend.expand_bases() 7th argument (penalty) can't be converted to int");
    if (f2py_success) {
    /* Processing variable lof */
    /* Processing variable nbases */
    /* Processing variable mask */
    mask_Dims[0]=max_nbases,mask_Dims[1]=max_nbases;
    capi_mask_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.expand_bases: failed to create array from the hidden `mask`";
    capi_mask_as_array = ndarray_from_pyobj(  NPY_INT,1,mask_Dims,mask_Rank,  capi_mask_intent,Py_None,capi_errmess);
    if (capi_mask_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mask = (int *)(PyArray_DATA(capi_mask_as_array));

    /* Processing variable truncated */
    truncated_Dims[0]=max_nbases,truncated_Dims[1]=max_nbases;
    capi_truncated_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.expand_bases: failed to create array from the hidden `truncated`";
    capi_truncated_as_array = ndarray_from_pyobj(  NPY_INT,1,truncated_Dims,truncated_Rank,  capi_truncated_intent,Py_None,capi_errmess);
    if (capi_truncated_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        truncated = (int *)(PyArray_DATA(capi_truncated_as_array));

    /* Processing variable cov */
    cov_Dims[0]=max_nbases,cov_Dims[1]=max_nbases;
    capi_cov_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.expand_bases: failed to create array from the hidden `cov`";
    capi_cov_as_array = ndarray_from_pyobj(  NPY_INT,1,cov_Dims,cov_Rank,  capi_cov_intent,Py_None,capi_errmess);
    if (capi_cov_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        cov = (int *)(PyArray_DATA(capi_cov_as_array));

    /* Processing variable root */
    root_Dims[0]=max_nbases,root_Dims[1]=max_nbases;
    capi_root_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.expand_bases: failed to create array from the hidden `root`";
    capi_root_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,root_Dims,root_Rank,  capi_root_intent,Py_None,capi_errmess);
    if (capi_root_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        root = (double *)(PyArray_DATA(capi_root_as_array));

    /* Processing variable coefficients_out */
    coefficients_out_Dims[0]=-1 + max_nbases;
    capi_coefficients_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.expand_bases: failed to create array from the hidden `coefficients_out`";
    capi_coefficients_out_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,coefficients_out_Dims,coefficients_out_Rank,  capi_coefficients_out_intent,Py_None,capi_errmess);
    if (capi_coefficients_out_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        coefficients_out = (double *)(PyArray_DATA(capi_coefficients_out_as_array));

    /* Processing variable f2py_x_d0 */
    f2py_x_d0 = shape(x, 0);
    /* Processing variable f2py_x_d1 */
    f2py_x_d1 = shape(x, 1);
    /* Processing variable f2py_y_d0 */
    f2py_y_d0 = shape(y, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(x,y,&y_mean,&max_nbases,&max_ncandidates,&aging_factor,&penalty,&lof,&nbases,mask,truncated,cov,root,coefficients_out,&f2py_x_d0,&f2py_x_d1,&f2py_y_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("diNNNNN",lof,nbases,capi_mask_as_array,capi_truncated_as_array,capi_cov_as_array,capi_root_as_array,capi_coefficients_out_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_y_d0 */
    /* End of cleaning variable f2py_x_d1 */
    /* End of cleaning variable f2py_x_d0 */
    }  /* if (capi_coefficients_out_as_array == NULL) ... else of coefficients_out */
    /* End of cleaning variable coefficients_out */
    }  /* if (capi_root_as_array == NULL) ... else of root */
    /* End of cleaning variable root */
    }  /* if (capi_cov_as_array == NULL) ... else of cov */
    /* End of cleaning variable cov */
    }  /* if (capi_truncated_as_array == NULL) ... else of truncated */
    /* End of cleaning variable truncated */
    }  /* if (capi_mask_as_array == NULL) ... else of mask */
    /* End of cleaning variable mask */
    /* End of cleaning variable nbases */
    /* End of cleaning variable lof */
    } /*if (f2py_success) of penalty*/
    /* End of cleaning variable penalty */
    } /*if (f2py_success) of aging_factor*/
    /* End of cleaning variable aging_factor */
    } /*if (f2py_success) of max_ncandidates*/
    /* End of cleaning variable max_ncandidates */
    } /*if (f2py_success) of max_nbases*/
    /* End of cleaning variable max_nbases */
    } /*if (f2py_success) of y_mean*/
    /* End of cleaning variable y_mean */
    if((PyObject *)capi_y_as_array!=y_capi) {
        Py_XDECREF(capi_y_as_array); }
    }  /* if (capi_y_as_array == NULL) ... else of y */
    /* End of cleaning variable y */
    if((PyObject *)capi_x_as_array!=x_capi) {
        Py_XDECREF(capi_x_as_array); }
    }  /* if (capi_x_as_array == NULL) ... else of x */
    /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************************** end of expand_bases ****************************/

/******************************** prune_bases ********************************/
static char doc_f2py_rout_backend_backend_prune_bases[] = "\
coefficients_out,mask = prune_bases(x,y,y_mean,lof,nbases,mask_in,truncated,cov,root,penalty)\n\nWrapper for ``prune_bases``.\
\n\nParameters\n----------\n"
"x : input rank-2 array('d') with bounds (f2py_x_d0,f2py_x_d1)\n"
"y : input rank-1 array('d') with bounds (f2py_y_d0)\n"
"y_mean : input float\n"
"lof : in/output rank-0 array(float,'d')\n"
"nbases : in/output rank-0 array(int,'i')\n"
"mask_in : input rank-2 array('i') with bounds (f2py_mask_in_d0,f2py_mask_in_d1)\n"
"truncated : input rank-2 array('i') with bounds (f2py_truncated_d0,f2py_truncated_d1)\n"
"cov : input rank-2 array('i') with bounds (f2py_cov_d0,f2py_cov_d1)\n"
"root : input rank-2 array('d') with bounds (f2py_root_d0,f2py_root_d1)\n"
"penalty : input int\n"
"\nReturns\n-------\n"
"coefficients_out : rank-1 array('d') with bounds (-1 + nbases)\n"
"mask : rank-2 array('i') with bounds (size(mask_in, 1),size(mask_in, 2))";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_prune_bases(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,int*,int*,int*,double*,int*,double*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *x = NULL;
    npy_intp x_Dims[2] = {-1, -1};
    const int x_Rank = 2;
    PyArrayObject *capi_x_as_array = NULL;
    int capi_x_intent = 0;
    PyObject *x_capi = Py_None;
    double *y = NULL;
    npy_intp y_Dims[1] = {-1};
    const int y_Rank = 1;
    PyArrayObject *capi_y_as_array = NULL;
    int capi_y_intent = 0;
    PyObject *y_capi = Py_None;
    double y_mean = 0;
    PyObject *y_mean_capi = Py_None;
    double lof = 0;
    PyObject *lof_capi = Py_None;
    int nbases = 0;
    PyObject *nbases_capi = Py_None;
    int *mask_in = NULL;
    npy_intp mask_in_Dims[2] = {-1, -1};
    const int mask_in_Rank = 2;
    PyArrayObject *capi_mask_in_as_array = NULL;
    int capi_mask_in_intent = 0;
    PyObject *mask_in_capi = Py_None;
    int *truncated = NULL;
    npy_intp truncated_Dims[2] = {-1, -1};
    const int truncated_Rank = 2;
    PyArrayObject *capi_truncated_as_array = NULL;
    int capi_truncated_intent = 0;
    PyObject *truncated_capi = Py_None;
    int *cov = NULL;
    npy_intp cov_Dims[2] = {-1, -1};
    const int cov_Rank = 2;
    PyArrayObject *capi_cov_as_array = NULL;
    int capi_cov_intent = 0;
    PyObject *cov_capi = Py_None;
    double *root = NULL;
    npy_intp root_Dims[2] = {-1, -1};
    const int root_Rank = 2;
    PyArrayObject *capi_root_as_array = NULL;
    int capi_root_intent = 0;
    PyObject *root_capi = Py_None;
    int penalty = 0;
    PyObject *penalty_capi = Py_None;
    double *coefficients_out = NULL;
    npy_intp coefficients_out_Dims[1] = {-1};
    const int coefficients_out_Rank = 1;
    PyArrayObject *capi_coefficients_out_as_array = NULL;
    int capi_coefficients_out_intent = 0;
    int *mask = NULL;
    npy_intp mask_Dims[2] = {-1, -1};
    const int mask_Rank = 2;
    PyArrayObject *capi_mask_as_array = NULL;
    int capi_mask_intent = 0;
    int f2py_x_d0 = 0;
    int f2py_x_d1 = 0;
    int f2py_y_d0 = 0;
    int f2py_mask_in_d0 = 0;
    int f2py_mask_in_d1 = 0;
    int f2py_truncated_d0 = 0;
    int f2py_truncated_d1 = 0;
    int f2py_cov_d0 = 0;
    int f2py_cov_d1 = 0;
    int f2py_root_d0 = 0;
    int f2py_root_d1 = 0;
    static char *capi_kwlist[] = {"x","y","y_mean","lof","nbases","mask_in","truncated","cov","root","penalty",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOO|:backend.backend.prune_bases",\
        capi_kwlist,&x_capi,&y_capi,&y_mean_capi,&lof_capi,&nbases_capi,&mask_in_capi,&truncated_capi,&cov_capi,&root_capi,&penalty_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable x */
    ;
    capi_x_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.prune_bases: failed to create array from the 1st argument `x`";
    capi_x_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,x_Dims,x_Rank,  capi_x_intent,x_capi,capi_errmess);
    if (capi_x_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        x = (double *)(PyArray_DATA(capi_x_as_array));

    /* Processing variable y */
    ;
    capi_y_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.prune_bases: failed to create array from the 2nd argument `y`";
    capi_y_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,y_Dims,y_Rank,  capi_y_intent,y_capi,capi_errmess);
    if (capi_y_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        y = (double *)(PyArray_DATA(capi_y_as_array));

    /* Processing variable y_mean */
        f2py_success = double_from_pyobj(&y_mean,y_mean_capi,"backend.backend.prune_bases() 3rd argument (y_mean) can't be converted to double");
    if (f2py_success) {
    /* Processing variable lof */
        f2py_success = double_from_pyobj(&lof,lof_capi,"backend.backend.prune_bases() 4th argument (lof) can't be converted to double");
    if (f2py_success) {
    /* Processing variable nbases */
        f2py_success = int_from_pyobj(&nbases,nbases_capi,"backend.backend.prune_bases() 5th argument (nbases) can't be converted to int");
    if (f2py_success) {
    /* Processing variable mask_in */
    ;
    capi_mask_in_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.prune_bases: failed to create array from the 6th argument `mask_in`";
    capi_mask_in_as_array = ndarray_from_pyobj(  NPY_INT,1,mask_in_Dims,mask_in_Rank,  capi_mask_in_intent,mask_in_capi,capi_errmess);
    if (capi_mask_in_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mask_in = (int *)(PyArray_DATA(capi_mask_in_as_array));

    /* Processing variable truncated */
    ;
    capi_truncated_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.prune_bases: failed to create array from the 7th argument `truncated`";
    capi_truncated_as_array = ndarray_from_pyobj(  NPY_INT,1,truncated_Dims,truncated_Rank,  capi_truncated_intent,truncated_capi,capi_errmess);
    if (capi_truncated_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        truncated = (int *)(PyArray_DATA(capi_truncated_as_array));

    /* Processing variable cov */
    ;
    capi_cov_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.prune_bases: failed to create array from the 8th argument `cov`";
    capi_cov_as_array = ndarray_from_pyobj(  NPY_INT,1,cov_Dims,cov_Rank,  capi_cov_intent,cov_capi,capi_errmess);
    if (capi_cov_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        cov = (int *)(PyArray_DATA(capi_cov_as_array));

    /* Processing variable root */
    ;
    capi_root_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.prune_bases: failed to create array from the 9th argument `root`";
    capi_root_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,root_Dims,root_Rank,  capi_root_intent,root_capi,capi_errmess);
    if (capi_root_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        root = (double *)(PyArray_DATA(capi_root_as_array));

    /* Processing variable penalty */
        f2py_success = int_from_pyobj(&penalty,penalty_capi,"backend.backend.prune_bases() 10th argument (penalty) can't be converted to int");
    if (f2py_success) {
    /* Processing variable coefficients_out */
    coefficients_out_Dims[0]=-1 + nbases;
    capi_coefficients_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.prune_bases: failed to create array from the hidden `coefficients_out`";
    capi_coefficients_out_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,coefficients_out_Dims,coefficients_out_Rank,  capi_coefficients_out_intent,Py_None,capi_errmess);
    if (capi_coefficients_out_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        coefficients_out = (double *)(PyArray_DATA(capi_coefficients_out_as_array));

    /* Processing variable mask */
    mask_Dims[0]=size(mask_in, 1),mask_Dims[1]=size(mask_in, 2);
    capi_mask_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.prune_bases: failed to create array from the hidden `mask`";
    capi_mask_as_array = ndarray_from_pyobj(  NPY_INT,1,mask_Dims,mask_Rank,  capi_mask_intent,Py_None,capi_errmess);
    if (capi_mask_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mask = (int *)(PyArray_DATA(capi_mask_as_array));

    /* Processing variable f2py_x_d0 */
    f2py_x_d0 = shape(x, 0);
    /* Processing variable f2py_x_d1 */
    f2py_x_d1 = shape(x, 1);
    /* Processing variable f2py_y_d0 */
    f2py_y_d0 = shape(y, 0);
    /* Processing variable f2py_mask_in_d0 */
    f2py_mask_in_d0 = shape(mask_in, 0);
    /* Processing variable f2py_mask_in_d1 */
    f2py_mask_in_d1 = shape(mask_in, 1);
    /* Processing variable f2py_truncated_d0 */
    f2py_truncated_d0 = shape(truncated, 0);
    /* Processing variable f2py_truncated_d1 */
    f2py_truncated_d1 = shape(truncated, 1);
    /* Processing variable f2py_cov_d0 */
    f2py_cov_d0 = shape(cov, 0);
    /* Processing variable f2py_cov_d1 */
    f2py_cov_d1 = shape(cov, 1);
    /* Processing variable f2py_root_d0 */
    f2py_root_d0 = shape(root, 0);
    /* Processing variable f2py_root_d1 */
    f2py_root_d1 = shape(root, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(x,y,&y_mean,&lof,&nbases,mask_in,truncated,cov,root,&penalty,coefficients_out,mask,&f2py_x_d0,&f2py_x_d1,&f2py_y_d0,&f2py_mask_in_d0,&f2py_mask_in_d1,&f2py_truncated_d0,&f2py_truncated_d1,&f2py_cov_d0,&f2py_cov_d1,&f2py_root_d0,&f2py_root_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
    f2py_success = try_pyarr_from_double(lof_capi,&lof);
    if (f2py_success) {
    f2py_success = try_pyarr_from_int(nbases_capi,&nbases);
    if (f2py_success) {
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NN",capi_coefficients_out_as_array,capi_mask_as_array);
/*closepyobjfrom*/
    } /*if (f2py_success) of nbases pyobjfrom*/
    } /*if (f2py_success) of lof pyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_root_d1 */
    /* End of cleaning variable f2py_root_d0 */
    /* End of cleaning variable f2py_cov_d1 */
    /* End of cleaning variable f2py_cov_d0 */
    /* End of cleaning variable f2py_truncated_d1 */
    /* End of cleaning variable f2py_truncated_d0 */
    /* End of cleaning variable f2py_mask_in_d1 */
    /* End of cleaning variable f2py_mask_in_d0 */
    /* End of cleaning variable f2py_y_d0 */
    /* End of cleaning variable f2py_x_d1 */
    /* End of cleaning variable f2py_x_d0 */
    }  /* if (capi_mask_as_array == NULL) ... else of mask */
    /* End of cleaning variable mask */
    }  /* if (capi_coefficients_out_as_array == NULL) ... else of coefficients_out */
    /* End of cleaning variable coefficients_out */
    } /*if (f2py_success) of penalty*/
    /* End of cleaning variable penalty */
    if((PyObject *)capi_root_as_array!=root_capi) {
        Py_XDECREF(capi_root_as_array); }
    }  /* if (capi_root_as_array == NULL) ... else of root */
    /* End of cleaning variable root */
    if((PyObject *)capi_cov_as_array!=cov_capi) {
        Py_XDECREF(capi_cov_as_array); }
    }  /* if (capi_cov_as_array == NULL) ... else of cov */
    /* End of cleaning variable cov */
    if((PyObject *)capi_truncated_as_array!=truncated_capi) {
        Py_XDECREF(capi_truncated_as_array); }
    }  /* if (capi_truncated_as_array == NULL) ... else of truncated */
    /* End of cleaning variable truncated */
    if((PyObject *)capi_mask_in_as_array!=mask_in_capi) {
        Py_XDECREF(capi_mask_in_as_array); }
    }  /* if (capi_mask_in_as_array == NULL) ... else of mask_in */
    /* End of cleaning variable mask_in */
    } /*if (f2py_success) of nbases*/
    /* End of cleaning variable nbases */
    } /*if (f2py_success) of lof*/
    /* End of cleaning variable lof */
    } /*if (f2py_success) of y_mean*/
    /* End of cleaning variable y_mean */
    if((PyObject *)capi_y_as_array!=y_capi) {
        Py_XDECREF(capi_y_as_array); }
    }  /* if (capi_y_as_array == NULL) ... else of y */
    /* End of cleaning variable y */
    if((PyObject *)capi_x_as_array!=x_capi) {
        Py_XDECREF(capi_x_as_array); }
    }  /* if (capi_x_as_array == NULL) ... else of x */
    /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of prune_bases *****************************/

/********************************* find_bases *********************************/
static char doc_f2py_rout_backend_backend_find_bases[] = "\
lof,nbases,mask,truncated,cov,root,coefficients_out = find_bases(x,y,y_mean,max_nbases,max_ncandidates,aging_factor,penalty)\n\nWrapper for ``find_bases``.\
\n\nParameters\n----------\n"
"x : input rank-2 array('d') with bounds (f2py_x_d0,f2py_x_d1)\n"
"y : input rank-1 array('d') with bounds (f2py_y_d0)\n"
"y_mean : input float\n"
"max_nbases : input int\n"
"max_ncandidates : input int\n"
"aging_factor : input float\n"
"penalty : input int\n"
"\nReturns\n-------\n"
"lof : float\n"
"nbases : int\n"
"mask : rank-2 array('i') with bounds (max_nbases,max_nbases)\n"
"truncated : rank-2 array('i') with bounds (max_nbases,max_nbases)\n"
"cov : rank-2 array('i') with bounds (max_nbases,max_nbases)\n"
"root : rank-2 array('d') with bounds (max_nbases,max_nbases)\n"
"coefficients_out : rank-1 array('d') with bounds (-1 + max_nbases)";
/* #declfortranroutine# */
static PyObject *f2py_rout_backend_backend_find_bases(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,int*,double*,int*,double*,int*,int*,int*,int*,double*,double*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *x = NULL;
    npy_intp x_Dims[2] = {-1, -1};
    const int x_Rank = 2;
    PyArrayObject *capi_x_as_array = NULL;
    int capi_x_intent = 0;
    PyObject *x_capi = Py_None;
    double *y = NULL;
    npy_intp y_Dims[1] = {-1};
    const int y_Rank = 1;
    PyArrayObject *capi_y_as_array = NULL;
    int capi_y_intent = 0;
    PyObject *y_capi = Py_None;
    double y_mean = 0;
    PyObject *y_mean_capi = Py_None;
    int max_nbases = 0;
    PyObject *max_nbases_capi = Py_None;
    int max_ncandidates = 0;
    PyObject *max_ncandidates_capi = Py_None;
    double aging_factor = 0;
    PyObject *aging_factor_capi = Py_None;
    int penalty = 0;
    PyObject *penalty_capi = Py_None;
    double lof = 0;
    int nbases = 0;
    int *mask = NULL;
    npy_intp mask_Dims[2] = {-1, -1};
    const int mask_Rank = 2;
    PyArrayObject *capi_mask_as_array = NULL;
    int capi_mask_intent = 0;
    int *truncated = NULL;
    npy_intp truncated_Dims[2] = {-1, -1};
    const int truncated_Rank = 2;
    PyArrayObject *capi_truncated_as_array = NULL;
    int capi_truncated_intent = 0;
    int *cov = NULL;
    npy_intp cov_Dims[2] = {-1, -1};
    const int cov_Rank = 2;
    PyArrayObject *capi_cov_as_array = NULL;
    int capi_cov_intent = 0;
    double *root = NULL;
    npy_intp root_Dims[2] = {-1, -1};
    const int root_Rank = 2;
    PyArrayObject *capi_root_as_array = NULL;
    int capi_root_intent = 0;
    double *coefficients_out = NULL;
    npy_intp coefficients_out_Dims[1] = {-1};
    const int coefficients_out_Rank = 1;
    PyArrayObject *capi_coefficients_out_as_array = NULL;
    int capi_coefficients_out_intent = 0;
    int f2py_x_d0 = 0;
    int f2py_x_d1 = 0;
    int f2py_y_d0 = 0;
    static char *capi_kwlist[] = {"x","y","y_mean","max_nbases","max_ncandidates","aging_factor","penalty",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOO|:backend.backend.find_bases",\
        capi_kwlist,&x_capi,&y_capi,&y_mean_capi,&max_nbases_capi,&max_ncandidates_capi,&aging_factor_capi,&penalty_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable x */
    ;
    capi_x_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.find_bases: failed to create array from the 1st argument `x`";
    capi_x_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,x_Dims,x_Rank,  capi_x_intent,x_capi,capi_errmess);
    if (capi_x_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        x = (double *)(PyArray_DATA(capi_x_as_array));

    /* Processing variable y */
    ;
    capi_y_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "backend.backend.backend.find_bases: failed to create array from the 2nd argument `y`";
    capi_y_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,y_Dims,y_Rank,  capi_y_intent,y_capi,capi_errmess);
    if (capi_y_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        y = (double *)(PyArray_DATA(capi_y_as_array));

    /* Processing variable y_mean */
        f2py_success = double_from_pyobj(&y_mean,y_mean_capi,"backend.backend.find_bases() 3rd argument (y_mean) can't be converted to double");
    if (f2py_success) {
    /* Processing variable max_nbases */
        f2py_success = int_from_pyobj(&max_nbases,max_nbases_capi,"backend.backend.find_bases() 4th argument (max_nbases) can't be converted to int");
    if (f2py_success) {
    /* Processing variable max_ncandidates */
        f2py_success = int_from_pyobj(&max_ncandidates,max_ncandidates_capi,"backend.backend.find_bases() 5th argument (max_ncandidates) can't be converted to int");
    if (f2py_success) {
    /* Processing variable aging_factor */
        f2py_success = double_from_pyobj(&aging_factor,aging_factor_capi,"backend.backend.find_bases() 6th argument (aging_factor) can't be converted to double");
    if (f2py_success) {
    /* Processing variable penalty */
        f2py_success = int_from_pyobj(&penalty,penalty_capi,"backend.backend.find_bases() 7th argument (penalty) can't be converted to int");
    if (f2py_success) {
    /* Processing variable lof */
    /* Processing variable nbases */
    /* Processing variable mask */
    mask_Dims[0]=max_nbases,mask_Dims[1]=max_nbases;
    capi_mask_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.find_bases: failed to create array from the hidden `mask`";
    capi_mask_as_array = ndarray_from_pyobj(  NPY_INT,1,mask_Dims,mask_Rank,  capi_mask_intent,Py_None,capi_errmess);
    if (capi_mask_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mask = (int *)(PyArray_DATA(capi_mask_as_array));

    /* Processing variable truncated */
    truncated_Dims[0]=max_nbases,truncated_Dims[1]=max_nbases;
    capi_truncated_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.find_bases: failed to create array from the hidden `truncated`";
    capi_truncated_as_array = ndarray_from_pyobj(  NPY_INT,1,truncated_Dims,truncated_Rank,  capi_truncated_intent,Py_None,capi_errmess);
    if (capi_truncated_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        truncated = (int *)(PyArray_DATA(capi_truncated_as_array));

    /* Processing variable cov */
    cov_Dims[0]=max_nbases,cov_Dims[1]=max_nbases;
    capi_cov_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.find_bases: failed to create array from the hidden `cov`";
    capi_cov_as_array = ndarray_from_pyobj(  NPY_INT,1,cov_Dims,cov_Rank,  capi_cov_intent,Py_None,capi_errmess);
    if (capi_cov_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        cov = (int *)(PyArray_DATA(capi_cov_as_array));

    /* Processing variable root */
    root_Dims[0]=max_nbases,root_Dims[1]=max_nbases;
    capi_root_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.find_bases: failed to create array from the hidden `root`";
    capi_root_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,root_Dims,root_Rank,  capi_root_intent,Py_None,capi_errmess);
    if (capi_root_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        root = (double *)(PyArray_DATA(capi_root_as_array));

    /* Processing variable coefficients_out */
    coefficients_out_Dims[0]=-1 + max_nbases;
    capi_coefficients_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "backend.backend.backend.find_bases: failed to create array from the hidden `coefficients_out`";
    capi_coefficients_out_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,coefficients_out_Dims,coefficients_out_Rank,  capi_coefficients_out_intent,Py_None,capi_errmess);
    if (capi_coefficients_out_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = backend_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        coefficients_out = (double *)(PyArray_DATA(capi_coefficients_out_as_array));

    /* Processing variable f2py_x_d0 */
    f2py_x_d0 = shape(x, 0);
    /* Processing variable f2py_x_d1 */
    f2py_x_d1 = shape(x, 1);
    /* Processing variable f2py_y_d0 */
    f2py_y_d0 = shape(y, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(x,y,&y_mean,&max_nbases,&max_ncandidates,&aging_factor,&penalty,&lof,&nbases,mask,truncated,cov,root,coefficients_out,&f2py_x_d0,&f2py_x_d1,&f2py_y_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("diNNNNN",lof,nbases,capi_mask_as_array,capi_truncated_as_array,capi_cov_as_array,capi_root_as_array,capi_coefficients_out_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_y_d0 */
    /* End of cleaning variable f2py_x_d1 */
    /* End of cleaning variable f2py_x_d0 */
    }  /* if (capi_coefficients_out_as_array == NULL) ... else of coefficients_out */
    /* End of cleaning variable coefficients_out */
    }  /* if (capi_root_as_array == NULL) ... else of root */
    /* End of cleaning variable root */
    }  /* if (capi_cov_as_array == NULL) ... else of cov */
    /* End of cleaning variable cov */
    }  /* if (capi_truncated_as_array == NULL) ... else of truncated */
    /* End of cleaning variable truncated */
    }  /* if (capi_mask_as_array == NULL) ... else of mask */
    /* End of cleaning variable mask */
    /* End of cleaning variable nbases */
    /* End of cleaning variable lof */
    } /*if (f2py_success) of penalty*/
    /* End of cleaning variable penalty */
    } /*if (f2py_success) of aging_factor*/
    /* End of cleaning variable aging_factor */
    } /*if (f2py_success) of max_ncandidates*/
    /* End of cleaning variable max_ncandidates */
    } /*if (f2py_success) of max_nbases*/
    /* End of cleaning variable max_nbases */
    } /*if (f2py_success) of y_mean*/
    /* End of cleaning variable y_mean */
    if((PyObject *)capi_y_as_array!=y_capi) {
        Py_XDECREF(capi_y_as_array); }
    }  /* if (capi_y_as_array == NULL) ... else of y */
    /* End of cleaning variable y */
    if((PyObject *)capi_x_as_array!=x_capi) {
        Py_XDECREF(capi_x_as_array); }
    }  /* if (capi_x_as_array == NULL) ... else of x */
    /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of find_bases *****************************/
/*eof body*/

/******************* See f2py2e/f90mod_rules.py: buildhooks *******************/

static FortranDataDef f2py_backend_def[] = {
  {"active_base_indices",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_active_base_indices,doc_f2py_rout_backend_backend_active_base_indices},
  {"data_matrix",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_data_matrix,doc_f2py_rout_backend_backend_data_matrix},
  {"covariance_matrix",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_covariance_matrix,doc_f2py_rout_backend_backend_covariance_matrix},
  {"rhs",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_rhs,doc_f2py_rout_backend_backend_rhs},
  {"coefficients",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_coefficients,doc_f2py_rout_backend_backend_coefficients},
  {"generalised_cross_validation",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_generalised_cross_validation,doc_f2py_rout_backend_backend_generalised_cross_validation},
  {"fit",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_fit,doc_f2py_rout_backend_backend_fit},
  {"update_init",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_update_init,doc_f2py_rout_backend_backend_update_init},
  {"update_data_matrix",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_update_data_matrix,doc_f2py_rout_backend_backend_update_data_matrix},
  {"update_covariance_matrix",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_update_covariance_matrix,doc_f2py_rout_backend_backend_update_covariance_matrix},
  {"update_rhs",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_update_rhs,doc_f2py_rout_backend_backend_update_rhs},
  {"decompose_addition",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_decompose_addition,doc_f2py_rout_backend_backend_decompose_addition},
  {"update_cholesky",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_update_cholesky,doc_f2py_rout_backend_backend_update_cholesky},
  {"update_coefficients",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_update_coefficients,doc_f2py_rout_backend_backend_update_coefficients},
  {"update_fit",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_update_fit,doc_f2py_rout_backend_backend_update_fit},
  {"argsort",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_argsort,doc_f2py_rout_backend_backend_argsort},
  {"add_bases",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_add_bases,doc_f2py_rout_backend_backend_add_bases},
  {"expand_bases",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_expand_bases,doc_f2py_rout_backend_backend_expand_bases},
  {"prune_bases",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_prune_bases,doc_f2py_rout_backend_backend_prune_bases},
  {"find_bases",-1,{{-1}},0,0,NULL,(void *)f2py_rout_backend_backend_find_bases,doc_f2py_rout_backend_backend_find_bases},
  {NULL}
};

static void f2py_setup_backend(char *active_base_indices,char *data_matrix,char *covariance_matrix,char *rhs,char *coefficients,char *generalised_cross_validation,char *fit,char *update_init,char *update_data_matrix,char *update_covariance_matrix,char *update_rhs,char *decompose_addition,char *update_cholesky,char *update_coefficients,char *update_fit,char *argsort,char *add_bases,char *expand_bases,char *prune_bases,char *find_bases) {
  int i_f2py=0;
  f2py_backend_def[i_f2py++].data = active_base_indices;
  f2py_backend_def[i_f2py++].data = data_matrix;
  f2py_backend_def[i_f2py++].data = covariance_matrix;
  f2py_backend_def[i_f2py++].data = rhs;
  f2py_backend_def[i_f2py++].data = coefficients;
  f2py_backend_def[i_f2py++].data = generalised_cross_validation;
  f2py_backend_def[i_f2py++].data = fit;
  f2py_backend_def[i_f2py++].data = update_init;
  f2py_backend_def[i_f2py++].data = update_data_matrix;
  f2py_backend_def[i_f2py++].data = update_covariance_matrix;
  f2py_backend_def[i_f2py++].data = update_rhs;
  f2py_backend_def[i_f2py++].data = decompose_addition;
  f2py_backend_def[i_f2py++].data = update_cholesky;
  f2py_backend_def[i_f2py++].data = update_coefficients;
  f2py_backend_def[i_f2py++].data = update_fit;
  f2py_backend_def[i_f2py++].data = argsort;
  f2py_backend_def[i_f2py++].data = add_bases;
  f2py_backend_def[i_f2py++].data = expand_bases;
  f2py_backend_def[i_f2py++].data = prune_bases;
  f2py_backend_def[i_f2py++].data = find_bases;
}
extern void F_FUNC(f2pyinitbackend,F2PYINITBACKEND)(void (*)(char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *));
static void f2py_init_backend(void) {
  F_FUNC(f2pyinitbackend,F2PYINITBACKEND)(f2py_setup_backend);
}

/*need_f90modhooks*/

/************** See f2py2e/rules.py: module_rules['modulebody'] **************/

/******************* See f2py2e/common_rules.py: buildhooks *******************/

/*need_commonhooks*/

/**************************** See f2py2e/rules.py ****************************/

static FortranDataDef f2py_routine_defs[] = {

/*eof routine_defs*/
    {NULL}
};

static PyMethodDef f2py_module_methods[] = {

    {NULL,NULL}
};

static struct PyModuleDef moduledef = {
    PyModuleDef_HEAD_INIT,
    "backend",
    NULL,
    -1,
    f2py_module_methods,
    NULL,
    NULL,
    NULL,
    NULL
};

PyMODINIT_FUNC PyInit_backend(void) {
    int i;
    PyObject *m,*d, *s, *tmp;
    m = backend_module = PyModule_Create(&moduledef);
    Py_SET_TYPE(&PyFortran_Type, &PyType_Type);
    import_array();
    if (PyErr_Occurred())
        {PyErr_SetString(PyExc_ImportError, "can't initialize module backend (failed to import numpy)"); return m;}
    d = PyModule_GetDict(m);
    s = PyUnicode_FromString("2.2.2");
    PyDict_SetItemString(d, "__version__", s);
    Py_DECREF(s);
    s = PyUnicode_FromString(
        "This module 'backend' is auto-generated with f2py (version:2.2.2).\nFunctions:\n"
"Fortran 90/95 modules:\n""  backend --- active_base_indices(),data_matrix(),covariance_matrix(),rhs(),coefficients(),generalised_cross_validation(),fit(),update_init(),update_data_matrix(),update_covariance_matrix(),update_rhs(),decompose_addition(),update_cholesky(),update_coefficients(),update_fit(),argsort(),add_bases(),expand_bases(),prune_bases(),find_bases()"".");
    PyDict_SetItemString(d, "__doc__", s);
    Py_DECREF(s);
    s = PyUnicode_FromString("2.2.2");
    PyDict_SetItemString(d, "__f2py_numpy_version__", s);
    Py_DECREF(s);
    backend_error = PyErr_NewException ("backend.error", NULL, NULL);
    /*
     * Store the error object inside the dict, so that it could get deallocated.
     * (in practice, this is a module, so it likely will not and cannot.)
     */
    PyDict_SetItemString(d, "_backend_error", backend_error);
    Py_DECREF(backend_error);
    for(i=0;f2py_routine_defs[i].name!=NULL;i++) {
        tmp = PyFortranObject_NewAsAttr(&f2py_routine_defs[i]);
        PyDict_SetItemString(d, f2py_routine_defs[i].name, tmp);
        Py_DECREF(tmp);
    }




















/*eof initf2pywraphooks*/
  PyDict_SetItemString(d, "backend", PyFortranObject_New(f2py_backend_def,f2py_init_backend));
/*eof initf90modhooks*/

/*eof initcommonhooks*/


#if Py_GIL_DISABLED
    // signal whether this module supports running with the GIL disabled
    PyUnstable_Module_SetGIL(m , Py_MOD_GIL_USED);
#endif

#ifdef F2PY_REPORT_ATEXIT
    if (! PyErr_Occurred())
        on_exit(f2py_report_on_exit,(void*)"backend");
#endif

    if (PyType_Ready(&PyFortran_Type) < 0) {
        return NULL;
    }

    return m;
}
#ifdef __cplusplus
}
#endif
